import{a as e}from"./authFunction-BTPmImWU.js";import a from"./orgTree-CG-9udoW.js";import{_ as t}from"./editUser.vue_vue_type_script_setup_true_name_sysEditUser_lang-bTp0aIPm.js";import{_ as o}from"./modifyRecord.vue_vue_type_script_setup_true_lang-BJJtdc8n.js";import{g as r}from"./index-DWGcUZYU.js";import{S as l}from"./sys-org-api-BuTSvnhC.js";import{S as s}from"./sys-user-api-CGBglDdl.js";import{c as i,E as n}from"./element-plus-B9gGnqkL.js";import{d,r as p,_ as u,j as m,ah as c,ap as g,o as y,c as f,V as w,P as v,Q as h,O as j,T as _,U as b,u as P}from"./@vue-CX_mlhJe.js";import"./@element-plus-BOmeTCVz.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./pinia-CUaEdNPK.js";import"./vue-demi-DMxTsK9-.js";import"./vue-DMOwXDUL.js";import"./@babel-Q_QrznUx.js";import"./jspdf-CH-AZmyM.js";import"./fflate-B3Xb404m.js";import"./vue-router-DCQgfElv.js";import"./vue-i18n-DOLUIXgH.js";import"./@intlify-8Jop7_C0.js";import"./js-cookie-BXEMiIsG.js";import"./nprogress-BXoedg-7.js";import"./axios-CURSphCx.js";import"./lodash-es-Bx2dc0Qf.js";import"./@vueuse-DXufPiA3.js";import"./@sxzz-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-DCN6noHZ.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DHjS97uh.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-DUD0Qdrs.js";import"./vform3-builds-n_pM9nIF.js";import"./vue-signature-pad-lyh4QR3Z.js";import"./signature_pad-edH0THtw.js";import"./merge-images-Cwm9rL5U.js";import"./vue3-tree-org-BzkJto3m.js";/* empty css                    */import"./vue-plugin-hiprint-DZDwPE-S.js";import"./jquery-VSNIoD5U.js";import"./jsbarcode-BgYCXnWS.js";import"./socket.io-client-Czs-wWz3.js";import"./engine.io-client-CYjl6Vq_.js";import"./engine.io-parser-BcOgFIoq.js";import"./@socket.io-mcuM6LAc.js";import"./debug-CmirTkX5.js";import"./ms-CufoL-nS.js";import"./socket.io-parser-CnrqkM7d.js";import"./canvg-FiHv1N34.js";import"./core-js-BJmvCVxN.js";import"./raf-B8RiLMb0.js";import"./performance-now-D4QiMMAM.js";import"./rgbcolor-Cv9DR9SS.js";import"./svg-pathdata-BQypvdxQ.js";import"./stackblur-canvas-WbqePTkn.js";import"./sys-pos-api-DICRJefz.js";import"./sys-role-api-CtWvDK07.js";const U={class:"sys-user-container"},k=d({name:"sysUser"}),x=d({...k,setup(d){const k=p(),x=p(),T=u({loading:!1,userData:[],orgTreeData:[],queryParams:{orgId:-1,account:void 0,realName:void 0,phone:void 0},tableParams:{page:1,pageSize:20,total:0},editUserTitle:""});m((async()=>{await z(),await q()}));const z=async()=>{T.loading=!0;let e=await r(l).apiSysOrgListGet(0);T.orgTreeData=e.data.result??[],T.loading=!1},q=async()=>{var e,a;T.loading=!0;let t=Object.assign(T.queryParams,T.tableParams),o=await r(s).apiSysUserPagePost(t);T.userData=(null==(e=o.data.result)?void 0:e.items)??[],T.tableParams.total=null==(a=o.data.result)?void 0:a.total,T.loading=!1},C=async()=>{T.queryParams.orgId=-1,T.queryParams.account=void 0,T.queryParams.realName=void 0,T.queryParams.phone=void 0,await q()},S=()=>{var e;T.editUserTitle="添加账号",null==(e=x.value)||e.openDialog({id:void 0,birthday:"2000-01-01",sex:1,orderNo:100,cardType:0,cultureLevel:5})},D=e=>{T.tableParams.pageSize=e,q()},N=async e=>{T.tableParams.page=e,await q()},V=async e=>{T.queryParams.orgId=e.id,T.queryParams.account=void 0,T.queryParams.realName=void 0,T.queryParams.phone=void 0,await q()};return(l,d)=>{const p=c("el-col"),u=c("el-input"),m=c("el-form-item"),z=c("el-button"),B=c("el-button-group"),L=c("el-form"),R=c("el-card"),E=c("el-table-column"),F=c("el-avatar"),$=c("el-tag"),I=c("el-switch"),M=c("el-dropdown-item"),O=c("el-dropdown-menu"),Q=c("el-dropdown"),G=c("el-table"),H=c("el-pagination"),K=c("el-row"),A=g("auth"),J=g("loading");return y(),f("div",U,[w(K,{gutter:5,style:{width:"100%",flex:"1"}},{default:v((()=>[w(p,{span:4,xs:24},{default:v((()=>[w(a,{ref_key:"orgTreeRef",ref:k,onNodeClick:V},null,512)])),_:1}),w(p,{span:20,xs:24,style:{display:"flex","flex-direction":"column"}},{default:v((()=>[w(R,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:v((()=>[w(L,{model:T.queryParams,ref:"queryForm",inline:!0},{default:v((()=>[w(m,{label:"账号"},{default:v((()=>[w(u,{modelValue:T.queryParams.account,"onUpdate:modelValue":d[0]||(d[0]=e=>T.queryParams.account=e),placeholder:"账号",clearable:""},null,8,["modelValue"])])),_:1}),w(m,{label:"手机号码"},{default:v((()=>[w(u,{modelValue:T.queryParams.phone,"onUpdate:modelValue":d[1]||(d[1]=e=>T.queryParams.phone=e),placeholder:"手机号码",clearable:""},null,8,["modelValue"])])),_:1}),w(m,null,{default:v((()=>[w(B,null,{default:v((()=>[h((y(),j(z,{type:"primary",icon:"ele-Search",onClick:q},{default:v((()=>[_(" 查询 ")])),_:1})),[[A,"sysUser:page"]]),w(z,{icon:"ele-Refresh",onClick:C},{default:v((()=>[_(" 重置 ")])),_:1})])),_:1})])),_:1}),w(m,null,{default:v((()=>[h((y(),j(z,{type:"primary",icon:"ele-Plus",onClick:S},{default:v((()=>[_(" 新增 ")])),_:1})),[[A,"sysUser:add"]])])),_:1})])),_:1},8,["model"])])),_:1}),w(R,{class:"full-table",shadow:"hover",style:{"margin-top":"5px"}},{default:v((()=>[h((y(),j(G,{data:T.userData,style:{width:"100%"},border:""},{default:v((()=>[w(E,{type:"index",label:"序号",width:"55",align:"center",fixed:""}),w(E,{label:"头像",width:"80",align:"center","show-overflow-tooltip":""},{default:v((e=>[w(F,{src:e.row.avatar,size:"small"},{default:v((()=>{var a,t;return[_(b((null==(a=e.row.nickName)?void 0:a.slice(0,1))??(null==(t=e.row.realName)?void 0:t.slice(0,1))),1)]})),_:2},1032,["src"])])),_:1}),w(E,{prop:"account",label:"账号",width:"120",align:"center","show-overflow-tooltip":""}),w(E,{prop:"realName",label:"姓名",width:"120",align:"center","show-overflow-tooltip":""}),w(E,{prop:"phone",label:"手机号码",width:"120",align:"center","show-overflow-tooltip":""}),w(E,{label:"账号类型",width:"110",align:"center","show-overflow-tooltip":""},{default:v((e=>[888===e.row.accountType?(y(),j($,{key:0},{default:v((()=>[_(" 系统管理员 ")])),_:1})):777===e.row.accountType?(y(),j($,{key:1},{default:v((()=>[_(" 普通账号 ")])),_:1})):666===e.row.accountType?(y(),j($,{key:2},{default:v((()=>[_(" 会员 ")])),_:1})):(y(),j($,{key:3},{default:v((()=>[_(" 其他 ")])),_:1}))])),_:1}),w(E,{prop:"roleName",label:"角色集合","min-width":"150",align:"center","show-overflow-tooltip":""}),w(E,{prop:"orgName",label:"所属机构","min-width":"120",align:"center","show-overflow-tooltip":""}),w(E,{prop:"posName",label:"职位名称","min-width":"120",align:"center","show-overflow-tooltip":""}),w(E,{label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:v((e=>[h(w(I,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,size:"small",onChange:a=>(async e=>{await r(s).apiSysUserSetStatusPost({id:e.id,status:e.status}).then((()=>{n.success("账号状态设置成功")})).catch((()=>{e.status=1==e.status?2:1}))})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"]),[[A,"sysUser:setStatus"]])])),_:1}),w(E,{prop:"orderNo",label:"排序",width:"70",align:"center","show-overflow-tooltip":""}),w(E,{label:"修改记录",width:"100",align:"center","show-overflow-tooltip":""},{default:v((e=>[w(o,{data:e.row},null,8,["data"])])),_:1}),w(E,{label:"操作",width:"130",align:"center",fixed:"right","show-overflow-tooltip":""},{default:v((a=>[h((y(),j(z,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:e=>{return t=a.row,T.editUserTitle="编辑账号",void(null==(o=x.value)||o.openDialog(t));var t,o}},{default:v((()=>[_(" 编辑 ")])),_:2},1032,["onClick"])),[[A,"sysUser:update"]]),w(Q,null,{dropdown:v((()=>[w(O,null,{default:v((()=>[w(M,{icon:"ele-RefreshLeft",onClick:e=>(async e=>{i.confirm(`确定重置密码：【${e.account}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await r(s).apiSysUserResetPwdPost({id:e.id}).then((e=>{n.success(`密码重置成功为：${e.data.result}`)}))})).catch((()=>{}))})(a.row),disabled:!P(e)("sysUser:resetPwd")},{default:v((()=>[_(" 重置密码 ")])),_:2},1032,["onClick","disabled"]),w(M,{icon:"ele-Unlock",onClick:e=>(async e=>{i.confirm(`确定解除登录锁定：【${e.account}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await r(s).apiSysUserUnlockLoginPost({id:e.id}).then((()=>{n.success("解除登录锁定成功")}))})).catch((()=>{}))})(a.row),divided:"",disabled:!P(e)("sysUser:unlockLogin")},{default:v((()=>[_(" 解除锁定 ")])),_:2},1032,["onClick","disabled"]),w(M,{icon:"ele-Delete",onClick:e=>{return t=a.row,void i.confirm(`确定删除账号：【${t.account}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await r(s).apiSysUserDeletePost({id:t.id}),await q(),n.success("删除成功")})).catch((()=>{}));var t},divided:"",disabled:!P(e)("sysUser:delete")},{default:v((()=>[_(" 删除账号 ")])),_:2},1032,["onClick","disabled"])])),_:2},1024)])),default:v((()=>[w(z,{icon:"ele-MoreFilled",size:"small",text:"",type:"primary",style:{"padding-left":"12px"}})])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[J,T.loading]]),w(H,{currentPage:T.tableParams.page,"onUpdate:currentPage":d[2]||(d[2]=e=>T.tableParams.page=e),"page-size":T.tableParams.pageSize,"onUpdate:pageSize":d[3]||(d[3]=e=>T.tableParams.pageSize=e),total:T.tableParams.total,"page-sizes":[10,20,50,100],size:"small",background:"",onSizeChange:D,onCurrentChange:N,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])),_:1})])),_:1})])),_:1}),w(t,{ref_key:"editUserRef",ref:x,title:T.editUserTitle,orgData:T.orgTreeData,onHandleQuery:q},null,8,["title","orgData"])])}}});export{x as default};

import{g as e}from"./index-DWGcUZYU.js";import{S as l}from"./sys-open-access-api-i-cLQgUm.js";import{S as a}from"./sys-tenant-api-rfUaKb-E.js";import{d as s,r,_ as t,j as o,ah as d,o as i,c as u,V as n,P as m,a as c,U as p,T as f,F as g,a8 as b,O as y}from"./@vue-CX_mlhJe.js";const S={class:"sys-open-access-container"},F={style:{color:"#fff"}},_={class:"dialog-footer"},h=s({name:"sysOpenAccessEdit"}),v=s({...h,props:{title:String},emits:["handleQuery"],setup(s,{expose:h,emit:v}){const w=s,V=v,x=r(),D=t({isShowDialog:!1,ruleForm:{},tenantData:[],userData:[]});o((async()=>{var l,s=await e(a).apiSysTenantPagePost({page:1,pageSize:1e4});D.tenantData=(null==(l=s.data.result)?void 0:l.items)??[]}));const U=()=>{D.isShowDialog=!1},I=()=>{x.value.validate((async a=>{a&&(null!=D.ruleForm.id&&D.ruleForm.id>0?await e(l).apiSysOpenAccessUpdatePost(D.ruleForm):await e(l).apiSysOpenAccessAddPost(D.ruleForm),V("handleQuery"),D.isShowDialog=!1)}))},k=async(l=!0)=>{var s=await e(a).apiSysTenantUserListPost({tenantId:D.ruleForm.bindTenantId??0});D.userData=s.data.result??[],l&&(D.ruleForm.bindUserId=void 0)},O=async()=>{var a=await e(l).apiSysOpenAccessSecretPost();D.ruleForm.accessSecret=a.data.result};return h({openDialog:e=>{var l;D.ruleForm=JSON.parse(JSON.stringify(e)),D.isShowDialog=!0,null==(l=x.value)||l.resetFields(),k(!1)}}),(e,l)=>{const a=d("ele-Edit"),s=d("el-icon"),r=d("el-input"),t=d("el-form-item"),o=d("el-col"),h=d("el-button"),v=d("el-option"),V=d("el-select"),P=d("el-row"),T=d("el-form"),j=d("el-dialog");return i(),u("div",S,[n(j,{modelValue:D.isShowDialog,"onUpdate:modelValue":l[4]||(l[4]=e=>D.isShowDialog=e),draggable:"","close-on-click-modal":!1,width:"600px"},{header:m((()=>[c("div",F,[n(s,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:m((()=>[n(a)])),_:1}),c("span",null,p(w.title),1)])])),footer:m((()=>[c("span",_,[n(h,{onClick:U},{default:m((()=>[f("取 消")])),_:1}),n(h,{type:"primary",onClick:I},{default:m((()=>[f("确 定")])),_:1})])])),default:m((()=>[n(T,{model:D.ruleForm,ref_key:"ruleFormRef",ref:x,"label-width":"auto"},{default:m((()=>[n(P,{gutter:35},{default:m((()=>[n(o,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:m((()=>[n(t,{label:"身份标识",prop:"accessKey",rules:[{required:!0,message:"身份标识不能为空",trigger:"blur"}]},{default:m((()=>[n(r,{modelValue:D.ruleForm.accessKey,"onUpdate:modelValue":l[0]||(l[0]=e=>D.ruleForm.accessKey=e),placeholder:"身份标识",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),n(o,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:m((()=>[n(t,{label:"密钥",prop:"accessSecret",rules:[{required:!0,message:"密钥不能为空",trigger:"blur"}]},{default:m((()=>[n(r,{modelValue:D.ruleForm.accessSecret,"onUpdate:modelValue":l[1]||(l[1]=e=>D.ruleForm.accessSecret=e),placeholder:"密钥",clearable:""},{append:m((()=>[n(h,{onClick:O},{default:m((()=>[f("生成密钥")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(o,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:m((()=>[n(t,{label:"绑定租户",prop:"bindTenantId",rules:[{required:!0,message:"绑定租户不能为空",trigger:"blur"}]},{default:m((()=>[n(V,{modelValue:D.ruleForm.bindTenantId,"onUpdate:modelValue":l[2]||(l[2]=e=>D.ruleForm.bindTenantId=e),placeholder:"绑定租户",filterable:"","default-first-option":"",style:{width:"100%"},onChange:k},{default:m((()=>[(i(!0),u(g,null,b(D.tenantData,(e=>(i(),y(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(o,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:m((()=>[n(t,{label:"绑定用户",prop:"bindUserId",rules:[{required:!0,message:"绑定用户不能为空",trigger:"blur"}]},{default:m((()=>[n(V,{modelValue:D.ruleForm.bindUserId,"onUpdate:modelValue":l[3]||(l[3]=e=>D.ruleForm.bindUserId=e),placeholder:"绑定用户",filterable:"","default-first-option":"",style:{width:"100%"}},{default:m((()=>[(i(!0),u(g,null,b(D.userData,(e=>(i(),y(v,{key:e.id,label:`${e.account}(${e.realName})`,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{v as _};

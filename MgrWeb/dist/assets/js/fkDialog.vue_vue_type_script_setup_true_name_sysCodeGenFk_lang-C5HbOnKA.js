import{g as e}from"./index-DWGcUZYU.js";import{S as l}from"./sys-code-gen-api-BI7DgiUl.js";import{d as a,r as o,_ as m,j as t,ah as u,o as n,c as s,V as r,P as d,a as i,T as c,F as f,a8 as b,O as g}from"./@vue-CX_mlhJe.js";const N={class:"sys-codeGenFk-container"},p={style:{color:"#fff"}},y=i("span",null," 外键配置",-1),F={class:"dialog-footer"},D=a({name:"sysCodeGenFk"}),k=a({...D,emits:["submitRefreshFk"],setup(a,{expose:D,emit:k}){var C={};const _=k,w=o(),h=m({isShowDialog:!1,ruleForm:{},dbData:[],tableData:[],columnData:[]});t((async()=>{await v()}));const v=async()=>{var a=await e(l).apiSysCodeGenDatabaseListGet();h.dbData=a.data.result},V=async()=>{if(""!=h.ruleForm.configId){var a=await e(l).apiSysCodeGenTableListConfigIdGet(h.ruleForm.configId);h.tableData=a.data.result}},x=async()=>{if(""!=h.ruleForm.configId&&""!=h.ruleForm.tableName){var a=await e(l).apiSysCodeGenColumnListByTableNameTableNameConfigIdGet(h.ruleForm.tableName,h.ruleForm.configId);h.columnData=a.data.result}},I=()=>{h.isShowDialog=!1},S=()=>{w.value.validate((async e=>{e&&(()=>{C.fkTableName=h.ruleForm.tableName;let e=h.tableData.filter((e=>e.tableName==h.ruleForm.tableName));C.fkEntityName=0==e.length?"":e[0].entityName,C.fkColumnName=h.ruleForm.columnName,C.fkLinkColumnName=h.ruleForm.linkColumnName;let l=h.columnData.filter((e=>e.columnName==h.ruleForm.columnName));C.fkColumnNetType=0==l.length?"":l[0].netType,_("submitRefreshFk",C),h.isShowDialog=!1})()}))};return D({openDialog:e=>{C=e,h.isShowDialog=!0}}),(e,l)=>{const a=u("ele-Edit"),o=u("el-icon"),m=u("el-option"),t=u("el-select"),D=u("el-form-item"),k=u("el-col"),C=u("el-row"),_=u("el-form"),v=u("el-button"),G=u("el-dialog");return n(),s("div",N,[r(G,{modelValue:h.isShowDialog,"onUpdate:modelValue":l[6]||(l[6]=e=>h.isShowDialog=e),draggable:"","close-on-click-modal":!1,width:"700px","destroy-on-close":""},{header:d((()=>[i("div",p,[r(o,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:d((()=>[r(a)])),_:1}),y])])),footer:d((()=>[i("span",F,[r(v,{onClick:I},{default:d((()=>[c("取 消")])),_:1}),r(v,{type:"primary",onClick:S},{default:d((()=>[c("确 定")])),_:1})])])),default:d((()=>[r(_,{model:h.ruleForm,ref_key:"ruleFormRef",ref:w,"label-width":"auto"},{default:d((()=>[r(C,{gutter:35},{default:d((()=>[r(k,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:d((()=>[r(D,{label:"库定位器",prop:"configId"},{default:d((()=>[r(t,{clearable:"",modelValue:h.ruleForm.configId,"onUpdate:modelValue":l[0]||(l[0]=e=>h.ruleForm.configId=e),placeholder:"库名",filterable:"",onChange:l[1]||(l[1]=e=>(async()=>{h.tableData=[],h.columnData=[],await V()})()),class:"w100"},{default:d((()=>[(n(!0),s(f,null,b(h.dbData,(e=>(n(),g(m,{key:e.configId,label:e.configId,value:e.configId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),r(k,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:d((()=>[r(D,{label:"数据库表",prop:"tableName"},{default:d((()=>[r(t,{modelValue:h.ruleForm.tableName,"onUpdate:modelValue":l[2]||(l[2]=e=>h.ruleForm.tableName=e),filterable:"",clearable:"",onChange:l[3]||(l[3]=e=>(async()=>{h.columnData=[],await x()})()),class:"w100"},{default:d((()=>[(n(!0),s(f,null,b(h.tableData,(e=>(n(),g(m,{key:e.entityName,label:e.entityName+" ( "+e.tableName+" )["+e.tableComment+"]",value:e.tableName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),r(k,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:d((()=>[r(D,{label:"显示字段",prop:"columnName"},{default:d((()=>[r(t,{modelValue:h.ruleForm.columnName,"onUpdate:modelValue":l[4]||(l[4]=e=>h.ruleForm.columnName=e),class:"w100"},{default:d((()=>[(n(!0),s(f,null,b(h.columnData,(e=>(n(),g(m,{key:e.columnName,label:e.columnName+" ["+e.columnComment+"]",value:e.columnName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),r(k,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:d((()=>[r(D,{label:"链接字段",prop:"linkColumnName"},{default:d((()=>[r(t,{modelValue:h.ruleForm.linkColumnName,"onUpdate:modelValue":l[5]||(l[5]=e=>h.ruleForm.linkColumnName=e),class:"w100"},{default:d((()=>[(n(!0),s(f,null,b(h.columnData,(e=>(n(),g(m,{key:e.columnName,label:e.columnName+" ["+e.columnComment+"]",value:e.columnName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{k as _};

import{v as e}from"./vcrontab-3-DLs5gnXJ.js";import{g as l}from"./index-DWGcUZYU.js";import{S as r}from"./sys-job-api-Be8QLoLy.js";import{E as o}from"./element-plus-B9gGnqkL.js";import{d as a,r as t,_ as s,k as i,ah as m,o as u,c as d,V as n,P as p,a as g,U as c,T as f,O as b,F as y,a8 as _,u as j,bm as x,bk as h}from"./@vue-CX_mlhJe.js";import{_ as F}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./@babel-Q_QrznUx.js";import"./vue-DMOwXDUL.js";import"./pinia-CUaEdNPK.js";import"./vue-demi-DMxTsK9-.js";import"./jspdf-CH-AZmyM.js";import"./fflate-B3Xb404m.js";import"./vue-router-DCQgfElv.js";import"./vue-i18n-DOLUIXgH.js";import"./@intlify-8Jop7_C0.js";import"./js-cookie-BXEMiIsG.js";import"./@element-plus-BOmeTCVz.js";import"./nprogress-BXoedg-7.js";import"./axios-CURSphCx.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-DUD0Qdrs.js";import"./vform3-builds-n_pM9nIF.js";import"./vue-signature-pad-lyh4QR3Z.js";import"./signature_pad-edH0THtw.js";import"./merge-images-Cwm9rL5U.js";import"./vue3-tree-org-BzkJto3m.js";/* empty css                    */import"./vue-plugin-hiprint-DZDwPE-S.js";import"./jquery-VSNIoD5U.js";import"./jsbarcode-BgYCXnWS.js";import"./socket.io-client-Czs-wWz3.js";import"./engine.io-client-CYjl6Vq_.js";import"./engine.io-parser-BcOgFIoq.js";import"./@socket.io-mcuM6LAc.js";import"./debug-CmirTkX5.js";import"./ms-CufoL-nS.js";import"./socket.io-parser-CnrqkM7d.js";import"./canvg-FiHv1N34.js";import"./core-js-BJmvCVxN.js";import"./raf-B8RiLMb0.js";import"./performance-now-D4QiMMAM.js";import"./rgbcolor-Cv9DR9SS.js";import"./svg-pathdata-BQypvdxQ.js";import"./stackblur-canvas-WbqePTkn.js";import"./lodash-es-Bx2dc0Qf.js";import"./@vueuse-DXufPiA3.js";import"./@sxzz-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-DCN6noHZ.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DHjS97uh.js";const v={class:"sys-jobTrigger-container"},V={style:{color:"#fff"}},w={class:"dialog-footer"},k={style:{color:"#fff"}},T=(e=>(x("data-v-c7eb8f3b"),e=e(),h(),e))((()=>g("span",null," Cron表达式生成器 ",-1))),S=a({name:"sysEditJobTrigger"}),D=F(a({...S,props:{title:String},emits:["handleQuery"],setup(a,{expose:x,emit:h}){const F=a,S=h,D=t(),C=s({isShowDialog:!1,ruleForm:{},showCronDialog:!1}),U=s([{key:"@secondly",description:"每秒 .0000000"},{key:"@minutely",description:"每分钟 00"},{key:"@hourly",description:"每小时 00:00"},{key:"@daily",description:"每天 00:00:00"},{key:"@monthly",description:"每月 1 号 00:00:00"},{key:"@weekly",description:"每周日 00:00:00"},{key:"@yearly",description:"每年 1 月 1 号 00:00:00"},{key:"@workday",description:"每周一至周五 00:00:00"}]),Y=i({get(){const e=void 0;if("Furion.Schedule.PeriodTrigger"!=C.ruleForm.triggerType)return e;if(!C.ruleForm.args)return e;const l=Number(C.ruleForm.args);return Number.isNaN(l)?e:l},set(e){C.ruleForm.args=String(e)}}),O=i({get(){if("Furion.Schedule.CronTrigger"!=C.ruleForm.triggerType)return"";if(!C.ruleForm.args)return"";const e=String(C.ruleForm.args),l=e.split(",");if(l.length<2)return"";if(2==l.length){return l[0].replace(new RegExp('"',"gm"),"").trim()}return e.substring(0,e.lastIndexOf(",")).replace(new RegExp('"',"gm"),"").trim()},set(e){if(C.ruleForm.args==e)return;const l=e.trim();let r=-1;r=l.startsWith("@")?0:6==l.split(" ").length?2:3,C.ruleForm.args=`"${l}",${r}`}}),N=()=>{C.isShowDialog=!1},M=()=>{D.value.validate((async e=>{e&&("Furion.Schedule.PeriodTrigger"!=C.ruleForm.triggerType||Y.value?"Furion.Schedule.CronTrigger"!=C.ruleForm.triggerType||O.value?(null!=C.ruleForm.id&&C.ruleForm.id>0?await l(r).apiSysJobUpdateJobTriggerPost(C.ruleForm):await l(r).apiSysJobAddJobTriggerPost(C.ruleForm),S("handleQuery"),C.isShowDialog=!1):o.warning("Cron表达式不能为空"):o.warning("间隔时间不能为空"))}))},z=e=>{O.value=null==e||null==e?"":e},H=e=>{O.value=e.key};return x({openDialog:e=>{var l;C.ruleForm=JSON.parse(JSON.stringify(e)),C.isShowDialog=!0,null==(l=D.value)||l.resetFields()}}),(l,r)=>{const o=m("ele-Edit"),a=m("el-icon"),t=m("el-input"),s=m("el-form-item"),i=m("el-col"),x=m("el-option"),h=m("el-select"),S=m("el-input-number"),E=m("el-button"),P=m("el-row"),I=m("el-dropdown-item"),J=m("el-dropdown-menu"),R=m("el-dropdown"),q=m("el-space"),Q=m("el-date-picker"),$=m("el-radio"),A=m("el-radio-group"),G=m("SvgIcon"),K=m("el-tooltip"),L=m("el-form"),W=m("el-dialog");return u(),d("div",v,[n(W,{modelValue:C.isShowDialog,"onUpdate:modelValue":r[15]||(r[15]=e=>C.isShowDialog=e),draggable:"","close-on-click-modal":!1,width:"700px"},{header:p((()=>[g("div",V,[n(a,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:p((()=>[n(o)])),_:1}),g("span",null,c(F.title),1)])])),footer:p((()=>[g("span",w,[n(E,{onClick:N},{default:p((()=>[f("取 消")])),_:1}),n(E,{type:"primary",onClick:M},{default:p((()=>[f("确 定")])),_:1})])])),default:p((()=>[n(L,{model:C.ruleForm,ref_key:"ruleFormRef",ref:D,"label-width":"auto"},{default:p((()=>[n(P,{gutter:35},{default:p((()=>[n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"触发器编号",prop:"triggerId",rules:[{required:!0,message:"触发器编号不能为空",trigger:"blur"}]},{default:p((()=>[n(t,{modelValue:C.ruleForm.triggerId,"onUpdate:modelValue":r[0]||(r[0]=e=>C.ruleForm.triggerId=e),placeholder:"触发器编号",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"触发器类型"},{default:p((()=>[n(h,{modelValue:C.ruleForm.triggerType,"onUpdate:modelValue":r[1]||(r[1]=e=>C.ruleForm.triggerType=e),style:{width:"100%"}},{default:p((()=>[n(x,{value:"Furion.Schedule.PeriodTrigger",label:"间隔"}),n(x,{value:"Furion.Schedule.CronTrigger",label:"Cron表达式"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),"Furion.Schedule.PeriodTrigger"==C.ruleForm.triggerType?(u(),b(i,{key:0,xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"间隔时间(ms)"},{default:p((()=>[n(S,{modelValue:Y.value,"onUpdate:modelValue":r[2]||(r[2]=e=>Y.value=e),placeholder:"间隔",min:1e3,step:1e3,class:"w100"},null,8,["modelValue"])])),_:1})])),_:1})):(u(),b(i,{key:1,xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:p((()=>[n(s,{label:"Cron表达式"},{default:p((()=>[n(t,{modelValue:O.value,"onUpdate:modelValue":r[4]||(r[4]=e=>O.value=e),placeholder:"Cron表达式"},{append:p((()=>[n(q,{size:10,spacer:"|"},{default:p((()=>[n(R,{style:{color:"inherit"},trigger:"click",onCommand:H},{dropdown:p((()=>[n(J,null,{default:p((()=>[(u(!0),d(y,null,_(U,((e,l)=>(u(),b(I,{key:l,command:e},{default:p((()=>[n(P,{style:{width:"240px"}},{default:p((()=>[n(i,{span:9},{default:p((()=>[f(c(e.key),1)])),_:2},1024),n(i,{span:15},{default:p((()=>[f(c(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["command"])))),128))])),_:1})])),default:p((()=>[n(E,{style:{margin:"0px -10px 0px -20px",color:"inherit"}},{default:p((()=>[f(" Macro ")])),_:1})])),_:1}),n(E,{style:{margin:"0px -20px 0px -10px","font-size":"14px"},onClick:r[3]||(r[3]=e=>C.showCronDialog=!0)},{default:p((()=>[f("Cron表达式")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"起始时间"},{default:p((()=>[n(Q,{modelValue:C.ruleForm.startTime,"onUpdate:modelValue":r[5]||(r[5]=e=>C.ruleForm.startTime=e),type:"datetime",placeholder:"起始时间",style:{width:"100%"},format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"结束时间"},{default:p((()=>[n(Q,{modelValue:C.ruleForm.endTime,"onUpdate:modelValue":r[6]||(r[6]=e=>C.ruleForm.endTime=e),type:"datetime",placeholder:"结束时间",style:{width:"100%"},format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"最大触发次数"},{default:p((()=>[n(S,{modelValue:C.ruleForm.maxNumberOfRuns,"onUpdate:modelValue":r[7]||(r[7]=e=>C.ruleForm.maxNumberOfRuns=e),placeholder:"最大触发次数",class:"w100"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"最大出错次数"},{default:p((()=>[n(S,{modelValue:C.ruleForm.maxNumberOfErrors,"onUpdate:modelValue":r[8]||(r[8]=e=>C.ruleForm.maxNumberOfErrors=e),placeholder:"最大出错次数",class:"w100"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"重试次数"},{default:p((()=>[n(S,{modelValue:C.ruleForm.numRetries,"onUpdate:modelValue":r[9]||(r[9]=e=>C.ruleForm.numRetries=e),placeholder:"重试次数",class:"w100"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"重试间隔(ms)"},{default:p((()=>[n(S,{modelValue:C.ruleForm.retryTimeout,"onUpdate:modelValue":r[10]||(r[10]=e=>C.ruleForm.retryTimeout=e),placeholder:"重试间隔ms",class:"w100"},null,8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"立即启动"},{default:p((()=>[n(A,{modelValue:C.ruleForm.startNow,"onUpdate:modelValue":r[11]||(r[11]=e=>C.ruleForm.startNow=e)},{default:p((()=>[n($,{value:!0},{default:p((()=>[f("是")])),_:1}),n($,{value:!1},{default:p((()=>[f("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:p((()=>[n(s,{label:"启动时执行一次"},{default:p((()=>[n(A,{modelValue:C.ruleForm.runOnStart,"onUpdate:modelValue":r[12]||(r[12]=e=>C.ruleForm.runOnStart=e)},{default:p((()=>[n($,{value:!0},{default:p((()=>[f("是")])),_:1}),n($,{value:!1},{default:p((()=>[f("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:p((()=>[n(s,null,{label:p((()=>[g("div",null,[f(" 重置触发次数 "),n(K,{"raw-content":"",content:"是否在启动时重置最大触发次数等于一次的作业<br/>解决因持久化数据已完成一次触发但启动时不再执行的问题",placement:"top"},{default:p((()=>[n(G,{name:"fa fa-question-circle-o",size:16,style:{"vertical-align":"middle"}})])),_:1})])])),default:p((()=>[n(A,{modelValue:C.ruleForm.resetOnlyOnce,"onUpdate:modelValue":r[13]||(r[13]=e=>C.ruleForm.resetOnlyOnce=e)},{default:p((()=>[n($,{value:!0},{default:p((()=>[f("是")])),_:1}),n($,{value:!1},{default:p((()=>[f("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),n(i,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:p((()=>[n(s,{label:"描述信息",prop:"description"},{default:p((()=>[n(t,{modelValue:C.ruleForm.description,"onUpdate:modelValue":r[14]||(r[14]=e=>C.ruleForm.description=e),placeholder:"描述信息",clearable:"",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),n(W,{modelValue:C.showCronDialog,"onUpdate:modelValue":r[17]||(r[17]=e=>C.showCronDialog=e),draggable:"","close-on-click-modal":!1,class:"scrollbar"},{header:p((()=>[g("div",k,[n(a,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:p((()=>[n(o)])),_:1}),T])])),default:p((()=>[n(j(e),{id:"vcrontab",onHide:r[16]||(r[16]=e=>C.showCronDialog=!1),onFill:z,expression:O.value},null,8,["expression"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-c7eb8f3b"]]);export{D as default};

import{d as e,r as l,_ as a,ah as t,o,c as i,V as d,P as n,a as u,T as r,F as s,a8 as m,u as p,a3 as c,O as b,S as f}from"./@vue-CX_mlhJe.js";import{g as y}from"./index-DWGcUZYU.js";import{S as g}from"./sys-database-api-V52ZKqx1.js";import{y as h,d as w}from"./database-CxmzcoGK.js";import{E as V}from"./element-plus-B9gGnqkL.js";const v={class:"sys-dbTable-container"},D={style:{color:"#fff"}},_=u("span",null," 增加表 ",-1),k={style:{"text-align":"left","margin-top":"10px"}},N={class:"dialog-footer"},T=e({name:"sysAddTable"}),C=e({...T,emits:["addTableSubmitted"],setup(e,{expose:T,emit:C}){var U=0;const I=C,x=l(),S=a({isShowDialog:!1,ruleForm:{},tableData:[]}),P=()=>{S.isShowDialog=!1},F=()=>{x.value.validate((async e=>{if(!e)return;if(0===S.tableData.length)return void V({type:"error",message:"请添加列!"});const l={dbColumnInfoList:S.tableData,...S.ruleForm};await y(g).apiSysDatabaseAddTablePost(l),I("addTableSubmitted",S.ruleForm.tableName??""),S.tableData=[],S.isShowDialog=!1}))};function j(){S.tableData.push({columnDescription:"主键Id",dataType:"bigint",dbColumnName:"Id",decimalDigits:0,isIdentity:0,isNullable:0,isPrimarykey:1,length:0,key:U,editable:!0,isNew:!0}),U++}function E(){S.tableData.push({columnDescription:"",dataType:"varchar",dbColumnName:"",decimalDigits:0,isIdentity:0,isNullable:1,isPrimarykey:0,length:32,key:U,editable:!0,isNew:!0}),U++}function O(){S.tableData.push({columnDescription:"租户Id",dataType:"bigint",dbColumnName:"TenantId",decimalDigits:0,isIdentity:0,isNullable:1,isPrimarykey:0,length:0,key:U,editable:!0,isNew:!0}),U++}function $(){[{dataType:"datetime",name:"CreateTime",desc:"创建时间"},{dataType:"datetime",name:"UpdateTime",desc:"更新时间"},{dataType:"bigint",name:"CreateUserId",desc:"创建者Id"},{dataType:"varchar",name:"CreateUserName",desc:"创建者姓名",length:64},{dataType:"bigint",name:"UpdateUserId",desc:"修改者Id"},{dataType:"varchar",name:"UpdateUserName",desc:"修改者姓名",length:64},{dataType:"bigint",name:"CreateOrgId",desc:"创建者部门Id"},{dataType:"varchar",name:"CreateOrgName",desc:"创建者部门名称",length:64},{dataType:"bit",name:"IsDelete",desc:"软删除",isNullable:0}].forEach((e=>{S.tableData.push({columnDescription:e.desc,dataType:e.dataType,dbColumnName:e.name,decimalDigits:0,isIdentity:0,isNullable:0===e.isNullable?0:1,isPrimarykey:0,length:e.length||0,key:U,editable:!0,isNew:!0}),U++}))}function q(e,l,a){let t=S.tableData.length-1;l>t&&(l=0),l<0&&(l=t);let o=a[e];return a[e]=a[l],a[l]=o,a}return T({openDialog:e=>{var l;S.ruleForm=e,S.isShowDialog=!0,null==(l=x.value)||l.resetFields()}}),(e,l)=>{const a=t("ele-Edit"),y=t("el-icon"),g=t("el-divider"),V=t("el-input"),T=t("el-form-item"),C=t("el-col"),U=t("el-row"),I=t("el-form"),A=t("el-table-column"),z=t("el-option"),B=t("el-select"),J=t("el-input-number"),L=t("el-button"),R=t("el-table"),G=t("el-dialog");return o(),i("div",v,[d(G,{modelValue:S.isShowDialog,"onUpdate:modelValue":l[2]||(l[2]=e=>S.isShowDialog=e),draggable:"","close-on-click-modal":!1,width:"1400px"},{header:n((()=>[u("div",D,[d(y,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:n((()=>[d(a)])),_:1}),_])])),footer:n((()=>[u("span",N,[d(L,{onClick:P},{default:n((()=>[r("取 消")])),_:1}),d(L,{type:"primary",onClick:F},{default:n((()=>[r("确 定")])),_:1})])])),default:n((()=>[d(g,{"content-position":"left"},{default:n((()=>[r("数据表信息")])),_:1}),d(I,{model:S.ruleForm,ref_key:"ruleFormRef",ref:x,"label-width":"auto"},{default:n((()=>[d(U,{gutter:35},{default:n((()=>[d(C,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:n((()=>[d(T,{label:"表名称",prop:"tableName",rules:[{required:!0,message:"名称不能为空",trigger:"blur"}]},{default:n((()=>[d(V,{modelValue:S.ruleForm.tableName,"onUpdate:modelValue":l[0]||(l[0]=e=>S.ruleForm.tableName=e),placeholder:"表名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),d(C,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:n((()=>[d(T,{label:"描述",prop:"description",rules:[{required:!0,message:"描述不能为空",trigger:"blur"}]},{default:n((()=>[d(V,{modelValue:S.ruleForm.description,"onUpdate:modelValue":l[1]||(l[1]=e=>S.ruleForm.description=e),placeholder:"描述",clearable:"",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),d(g,{"content-position":"left"},{default:n((()=>[r("数据列信息")])),_:1}),d(R,{data:S.tableData,style:{width:"100%"},"max-height":"400"},{default:n((()=>[d(A,{prop:"dbColumnName",label:"字段名",width:"220",fixed:""},{default:n((e=>[d(V,{modelValue:e.row.dbColumnName,"onUpdate:modelValue":l=>e.row.dbColumnName=l,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"columnDescription",label:"描述",width:"220"},{default:n((e=>[d(V,{modelValue:e.row.columnDescription,"onUpdate:modelValue":l=>e.row.columnDescription=l,autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"isPrimarykey",label:"主键",width:"100"},{default:n((e=>[d(B,{modelValue:e.row.isPrimarykey,"onUpdate:modelValue":l=>e.row.isPrimarykey=l,class:"m-2",placeholder:"Select"},{default:n((()=>[(o(!0),i(s,null,m(p(h),(e=>(o(),b(z,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"isIdentity",label:"自增",width:"100"},{default:n((e=>[d(B,{modelValue:e.row.isIdentity,"onUpdate:modelValue":l=>e.row.isIdentity=l,class:"m-2",placeholder:"Select"},{default:n((()=>[(o(!0),i(s,null,m(p(h),(e=>(o(),b(z,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"dataType",label:"类型",width:"150"},{default:n((e=>[d(B,{modelValue:e.row.dataType,"onUpdate:modelValue":l=>e.row.dataType=l,class:"m-2",placeholder:"Select"},{default:n((()=>[(o(!0),i(s,null,m(p(w),(e=>(o(),b(z,{key:e.value,label:e.value,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"isNullable",label:"可空",width:"100"},{default:n((e=>[d(B,{modelValue:e.row.isNullable,"onUpdate:modelValue":l=>e.row.isNullable=l,class:"m-2",placeholder:"Select"},{default:n((()=>[(o(!0),i(s,null,m(p(h),(e=>(o(),b(z,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"length",label:"长度",width:"100"},{default:n((e=>[d(J,{modelValue:e.row.length,"onUpdate:modelValue":l=>e.row.length=l,"controls-position":"right",class:"w100"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{prop:"decimalDigits",label:"小数位",width:"100"},{default:n((e=>[d(J,{modelValue:e.row.decimalDigits,"onUpdate:modelValue":l=>e.row.decimalDigits=l,"controls-position":"right",class:"w100"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(A,{label:"操作","min-width":"200",align:"center",fixed:"right"},{default:n((e=>[d(L,{link:"",type:"primary",icon:"el-icon-delete",onClick:c((l=>{return a=e.$index,void S.tableData.splice(a,1);var a}),["prevent"])},{default:n((()=>[r("删除")])),_:2},1032,["onClick"]),S.tableData.length>1?(o(),b(L,{key:0,link:"",type:"primary",icon:"ele-Top",onClick:c((l=>function(e,l){if(e.isNew)return q(l,l-1,S.tableData)}(e.row,e.$index)),["prevent"])},{default:n((()=>[r("上移")])),_:2},1032,["onClick"])):f("",!0),S.tableData.length>1?(o(),b(L,{key:1,link:"",type:"primary",icon:"ele-Bottom",onClick:c((l=>function(e,l){if(e.isNew)return q(l,l+1,S.tableData)}(e.row,e.$index)),["prevent"])},{default:n((()=>[r("下移")])),_:2},1032,["onClick"])):f("",!0)])),_:1})])),_:1},8,["data"]),u("div",k,[d(L,{icon:"ele-Plus",onClick:j},{default:n((()=>[r("新增主键字段")])),_:1}),d(L,{icon:"ele-Plus",onClick:E},{default:n((()=>[r("新增普通字段")])),_:1}),d(L,{icon:"ele-Plus",onClick:O},{default:n((()=>[r("新增租户字段")])),_:1}),d(L,{icon:"ele-Plus",onClick:$},{default:n((()=>[r("新增基础字段")])),_:1})])])),_:1},8,["modelValue"])])}}});export{C as _};

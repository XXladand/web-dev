import{a as e,o as n,c as t,U as o,S as a,J as l,d,r,I as s,K as u,ah as c,O as i,Q as p,W as f,V as m,aa as v,P as g,a6 as y,_ as h,X as b,ag as x,k as $,j as N,B as S,G as z,Z as D,w as E,n as C,a8 as M,F as k,ak as O,ap as w,y as _}from"./@vue-CX_mlhJe.js";const R=function(e){return"[object Object]"===Object.prototype.toString.call(e)},F=function(e){return"string"==typeof e},A=function(e){return"number"==typeof e},B={print:(e,n,t)=>F(n)||"boolean"==typeof t,pretty:(e,n,t)=>F(n)&&F(e)||"string"==typeof t,primary:(e,n)=>F(e)||"boolean"==typeof n,success:(e,n)=>F(e)||"boolean"==typeof n,info:(e,n)=>F(e)||"boolean"==typeof n,warning:(e,n)=>F(e)||"boolean"==typeof n,danger:(e,n)=>F(e)||"boolean"==typeof n};B.print=function(e,n="default",t=!1){return!0},B.pretty=function(e,n,t="primary"){return!0},B.primary=function(e,n=!1){return this.print&&this.print(e,"primary",n),!0},B.success=function(e,n=!1){return this.print&&this.print(e,"success",n),!0},B.info=function(e,n=!1){return this.print&&this.print(e,"info",n),!0},B.warning=function(e,n=!1){return this.print&&this.print(e,"warning",n),!0},B.danger=function(e,n=!1){return this.print&&this.print(e,"danger",n),!0};var L={async install(e){e.config.globalProperties.$log=B,B.pretty("[vue3-tree-org] 4.2.2","success")}};const T=function(){let e=!1;return{get:()=>e,set:n=>{e=n}}}(),j=function(e,n,t){const{id:o,children:a}=n;if(e[o]===t)return e;if(Array.isArray(e[a])){const o=e[a];for(let e=0,a=o.length;e<a;e++){const a=o[e],l=j(a,n,t);if(l)return l}}},P=function(e,n){const{parenNode:t,onlyOneNode:o,cloneNodeDrag:a}=n;if(t.value){const{keys:l}=n,{id:d,pid:r,children:s}=l,u=t.value.$$data,c=JSON.parse(JSON.stringify(e.$$data));a?(function(e,n){const{children:t}=n;if(R(e))o(e);else if(Array.isArray(e))for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(e){if(function(e){"string"==typeof e[d]&&-1!==e[d].indexOf("clone-node")&&(e[d]=`clone-node-${e[d]}`)}(e),Array.isArray(e[t])){const n=e[t];for(let e=0,t=n.length;e<t;e++)o(n[e])}}}(c,l),o&&Array.isArray(c[s])&&(c[s]=[]),c[l.pid]=u[l.id],u[s]?u[s].push(c):u[s]=[c]):(function(e,n){const{keys:t,data:o,onlyOneNode:a}=n,{id:l,pid:d,children:r}=t,s=j(o,t,e[d]),u=s[r];let c;for(let p=0,f=u.length;p<f;p++)if(u[p][l]===e[l]){u.splice(p,1),c=p;break}const i=e[r];a&&void 0!==c&&i&&(e[r]=[],i.forEach((e=>{e[d]=s[l]})),s[r].splice(c,0,...i))}(c,n),c[r]=u[d],u[s]?u[s].push(c):u[s]=[].concat(c))}},V={beforeMount(e,n){const{l:t,t:o}=n.modifiers,{drag:a,dragData:l,node:d,emit:r,beforeDragEnd:s,initNodes:u}=n.value,{value:c}=n,i={...l};e.addEventListener("mousedown",(function(e){const n=e.target;if(!1===a||0!==e.button||d.focused||d.$$data.noDragging||n.className.indexOf("tree-org-node-btn")>-1)return!1;(function(e){e.stopPropagation(),v=e.screenX,g=e.screenY,f=0,i.contextmenu.value=!1;const{keys:n,onlyOneNode:t}=i;if(t){const{children:e}=n,t={...d.$$data};t[e]=[],i.cloneData.value=u(t)}else i.cloneData.value=u(d.$$data)})(e),document.addEventListener("mousemove",y),document.addEventListener("mouseup",h),x("start")}));let p,f=0,m=!1,v=0,g=0;function y(n){return n.preventDefault(),!(Math.abs(n.screenX-v)<5&&Math.abs(n.screenY-g)<5)&&(m||(m=!0,function(n){T.set(!0),i.nodeMoving.value=!0,d.moving=!0;let t=e;for(;!t.classList.contains("tree-org-node");)f+=t.offsetLeft,t=t.offsetParent;f+=2,p=document.querySelector("#clone-tree-org"),p&&(p.style.width=`${t.clientWidth}px`,p.style.opacity="0.8",p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px")}(n)),t&&o&&c?(p&&(p.style.left=n.clientX-f+"px",p.style.top=n.clientY+2+"px"),void x("move")):t&&c?(e.style.left=n.clientX-f+"px",void x("move")):void(o&&c&&(e.style.top=n.clientY+"px",x("move"))))}function h(e){if(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",h),m){if("function"==typeof s){const n=s(d,i.parenNode.value);n&&n.then?n.then((()=>{b(e)}),(()=>{})):!1!==n&&b(e)}else b(e);m=!1,p=null,d.moving=!1,i.nodeMoving.value=!1,setTimeout((()=>{T.set(!1)}),200)}}function b(e){const n=document.querySelector(".tree-org-node__moving");if(n&&n.contains(e.target))return x("end"),!1;P(d,i),x("end")}function x(e){"start"!==e?"move"!==e?"end"===e&&r("on-node-drag-end",d,i.parenNode.value):r("on-node-drag",d):r("on-node-drag-start",d)}}},X={onClick:"onNodeClick",onDblclick:"onNodeDblclick",onContextmenu:"onNodeContextmenu",onMouseenter:"onNodeMouseenter",onMouseleave:"onNodeMouseleave"};function Y(e,n){if("function"==typeof e)return function(t){t.target.className.indexOf("org-tree-node-btn")>-1||e(t,n)}}const K=(e,n,t)=>!(Array.isArray(e[n])&&e[n].length>0)&&!t||e.isLeaf,W=(e,n,t)=>{const{attrs:o}=t,a=["tree-org-node"],l=[],{expand:d,children:r,id:s}=n;return K(n,"children",o.lazy)?a.push("is-leaf"):o.collapsable&&!d&&a.push("collapsed"),n.moving&&a.push("tree-org-node__moving"),l.push(q(e,n,t)),o.collapsable&&!d||l.push(U(e,r,t)),p(e("div",{class:a,key:s},l),[[f,!n.hidden]])},q=(e,n,t)=>{const{attrs:o}=t,a=o.props,l=o.renderContent,{label:d}=n,r=[];if(t.slots.default)r.push(t.slots.default({node:n}));else if("function"==typeof l){B.warning("scoped-slot header is easier to use. We recommend users to use scoped-slot header.");const t=l(e,n);t&&r.push(t)}else r.push(e("div",{class:"tree-org-node__text"},d));o.collapsable&&!K(n,"children",o.lazy)&&r.push(((e,n,t)=>{const{attrs:o}=t,a=o.onOnExpand,l=["tree-org-node__expand"];n.expand&&l.push("expanded");const d=[];return t.slots.expand?d.push(t.slots.expand({node:n})):d.push(e("span",{class:"tree-org-node__expand-btn"})),e("span",{class:l,onMousedown:e=>{e.stopPropagation()},onDblclick:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),a&&a(e,n)}},d)})(e,n,t));const s=["tree-org-node__inner"];let{labelStyle:u,labelClassName:c,selectedClassName:i,selectedKey:m}=o;"function"==typeof c&&(c=c(n)),c&&s.push(c),n.className&&s.push(n.className),"function"==typeof i&&(i=i(n)),void 0!==m&&(m=Array.isArray(m)?m:[m]),i&&m&&m.includes(n.id)&&s.push(i);const v=["tree-org-node__content"];n.$$root&&v.push(`is-root_${o.suffix}`),n.label||v.push("is-empty"),n.$$focused&&v.push("is-edit");const g=w("nodedrag"),y=[];o.vNodedrag&&g&&!n.$$root&&y.push([g,Object.assign({node:n},o.vNodedrag),"",{l:!0,t:!0}]);const h={};for(const p in X)if(Object.prototype.hasOwnProperty.call(X,p)){const e=o[X[p]];e&&(h[p]=Y(e,n))}const b=o.onNodeFocus,x=o.onNodeBlur,$=w("focus"),N=[[f,n.$$focused]];return $&&N.push([$,n.$$focused]),e("div",{class:v},[p(e("div",{class:s,style:n.style?n.style:u,...h},r),y),p(e("textarea",{class:"tree-org-node__textarea",placeholder:"请输入节点名称",value:n.label,onFocus:e=>{b&&b(e,n.$$data,n)},onInput:e=>{n.label=e.target.value},onBlur:e=>{void 0!==n.$$data.focused&&(n.$$data.focused=!1),n.$$data[a.label]=e.target.value,n.$$focused=!1,x&&x(e,n.$$data,n)},onClick:e=>e.stopPropagation()}),N)])},U=(e,n,t)=>{if(Array.isArray(n)&&n.length){const o=n.filter((e=>!e.$$hidden)).map((n=>W(e,n,t)));return e("div",{class:"tree-org-node__children"},o)}return""},I=(e,n)=>e.data&&0!==Object.keys(e.data).length?(e.data.$$root=!e.isClone,W(x,e.data,n)):"";I.directives={focus:{mounted(e,{value:n}){n&&e.focus()},updated(e,{value:n}){n&&e.focus()}},nodedrag:V};var J=d({props:{scale:String,tools:Object},setup(e,{emit:n}){const t=r(!1),o=r(!1);function a(e){o.value=!o.value,n("onFullscreen",e)}function l(){document.isFullScreen||document.mozIsFullScreen||document.webkitIsFullScreen||!o.value||a("esc")}const d=$((()=>t.value?"全部收起":"全部展开")),s=$((()=>o.value?"退出全屏":"全屏"));return N((()=>{window.addEventListener("resize",l)})),S((()=>{window.removeEventListener("resize",l)})),{expanded:t,fullscreen:o,expandTitle:d,fullTiltle:s,handleExpand:function(){t.value=!t.value,n("onExpand")},handleScale:function(e){"out"===e?n("onScale",.1):"in"===e?n("onScale",-.1):n("onRestore")},handleFullscreen:a}}});const H={class:"zm-tree-handle"},G={key:0,class:"zm-tree-percent"},Q=["title"],Z={class:"zm-tree-svg"},ee=[e("span",{class:"zm-tree-icon"},"+",-1)],ne=[e("span",{class:"zm-tree-icon"},"-",-1)],te=[e("span",{class:"zm-tree-restore"},null,-1)],oe=["title"],ae={class:"zm-tree-svg"};function le(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)}function de(e,n,t,o=1){return{deltaX:Math.round(n/o/e[0])*e[0],deltaY:Math.round(t/o/e[1])*e[1]}}function re(e,n,t){return e<n?n:t<e?t:e}J.render=function(d,r,s,u,c,i){return n(),t("div",H,[d.tools.scale?(n(),t("div",G,o(d.scale),1)):a("v-if",!0),d.tools.expand?(n(),t("div",{key:1,onClick:r[0]||(r[0]=(...e)=>d.handleExpand&&d.handleExpand(...e)),title:d.expandTitle,class:"zm-tree-handle-item"},[e("span",Z,[e("i",{class:l(["treefont",d.expanded?"icon-collapse":"icon-expand"])},null,2)])],8,Q)):a("v-if",!0),d.tools.zoom?(n(),t("div",{key:2,onClick:r[1]||(r[1]=e=>d.handleScale("out")),title:"放大",class:"zm-tree-handle-item zoom-out"},ee)):a("v-if",!0),d.tools.zoom?(n(),t("div",{key:3,onClick:r[2]||(r[2]=e=>d.handleScale("in")),title:"缩小",class:"zm-tree-handle-item zoom-in"},ne)):a("v-if",!0),d.tools.restore?(n(),t("div",{key:4,onClick:r[3]||(r[3]=e=>d.handleScale("restore")),title:"还原",class:"zm-tree-handle-item"},te)):a("v-if",!0),d.tools.fullscreen?(n(),t("div",{key:5,onClick:r[4]||(r[4]=(...e)=>d.handleFullscreen&&d.handleFullscreen(...e)),title:d.fullTiltle,class:"zm-tree-handle-item"},[e("span",ae,[e("i",{class:l(["treefont",d.fullscreen?"icon-unfullscreen":"icon-fullscreen"])},null,2)])],8,oe)):a("v-if",!0)])},J.__file="src/components/tools/tools.vue";const se=function(e,n,t,o=!1){e&&n&&t&&e.addEventListener(n,t,o)},ue=function(e,n,t,o=!1){e&&n&&t&&e.removeEventListener(n,t,o)},ce=Symbol("wrapper");function ie(e,n){if(null===(t=e)||"object"!=typeof t||e.__elPropsReservedKey)return e;var t;const{values:o,required:a,default:l,type:d,validator:r}=e,s=o||r?e=>{let t=!1,a=[];if(o&&(a=[...o,l],t=t||a.includes(e)),r&&(t=t||r(e)),!t&&a.length>0){const t=[...new Set(a)].map((e=>JSON.stringify(e))).join(", ");_(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${t}], got value ${JSON.stringify(e)}.`)}return t}:void 0;return{type:"object"==typeof d&&Object.getOwnPropertySymbols(d).includes(ce)?d[ce]:d,validator:s,__elPropsReservedKey:!0,default:l,required:!!a}}const pe=e=>function(e){let n=-1;const t=e?e.length:0,o={};for(;++n<t;){const t=e[n];o[t[0]]=t[1]}return o}(Object.entries(e).map((([e,n])=>[e,ie(n,e)]))),fe=e=>({[ce]:e});var me=d({replace:!0,name:"Draggable",props:pe({className:{type:String,default:"zm-draggable"},classNameDraggable:{type:String,default:"draggable"},classNameDragging:{type:String,default:"dragging"},classNameActive:{type:String,default:"active"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:e=>"string"==typeof e?"auto"===e:e>=0},dragCancel:String,axis:{type:String,default:"both",validator:e=>["x","y","both"].includes(e)},grid:{type:Array,default:()=>[1,1]},parent:{type:Boolean,default:!1},scale:{type:Number,default:1,validator:e=>e>0}}),emits:{activated:()=>!0,deactivated:()=>!0,dragging:(e,n)=>A(e)&&A(n),dragstop:(e,n)=>A(e)&&A(n),"update:active":e=>"boolean"==typeof e},setup(e,n){const t=r(),o=((e,{emit:n},t)=>{const o={start:"mousedown",move:"mousemove",stop:"mouseup"},a={start:"touchstart",move:"touchmove",stop:"touchend"},l={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},d={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let s=o;const u=r(e.x),c=r(e.y),i=r(e.z),p=r(e.active),f=r(!1),m=r(0),v=r(0),g=r(0),y=r(0),h=r(0),b=r(0);let x={},S={};function C(){x={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},S={minLeft:-1/0,maxLeft:1/0,minRight:-1/0,maxRight:1/0,minTop:-1/0,maxTop:1/0,minBottom:-1/0,maxBottom:1/0}}function M(){if(e.parent){const[e,n]=k();h.value=e||0,b.value=n||0}}function k(){if(e.parent&&t.eleRef.value){const e=window.getComputedStyle(t.eleRef.value.parentNode,null);return[parseInt(e.getPropertyValue("width"),10),parseInt(e.getPropertyValue("height"),10)]}return[0,0]}function O(o){if(o instanceof MouseEvent&&1!==o.which)return;const a=o.target||o.srcElement;if(a&&t.eleRef.value&&t.eleRef.value.contains(a)){if(e.dragCancel&&function(e,n,t){let o=e;const a=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find((e=>o&&le(o[e])))||"";if(!le(o[a]))return!1;do{if(o[a](n))return!0;if(o===t)return!1;o=o.parentNode}while(o);return!1}(a,e.dragCancel,t.eleRef.value))return void(f.value=!1);p.value||(p.value=!0,n("activated"),n("update:active",!0)),e.draggable&&(f.value=!0),o instanceof MouseEvent?(x.mouseX=o.pageX,x.mouseY=o.pageY):(x.mouseX=o.touches[0].pageX,x.mouseY=o.touches[0].pageY),x.left=u.value,x.right=m.value,x.top=c.value,x.bottom=v.value,e.parent&&(S=w()),se(document.documentElement,s.move,R),se(document.documentElement,s.stop,F)}}function w(){const n=e.grid;return{minLeft:u.value%n[0],maxLeft:Math.floor((h.value-g.value-u.value)/n[0])*n[0]+u.value,minRight:m.value%n[0],maxRight:Math.floor((h.value-g.value-m.value)/n[0])*n[0]+m.value,minTop:c.value%n[1],maxTop:Math.floor((b.value-y.value-c.value)/n[1])*n[1]+c.value,minBottom:v.value%n[1],maxBottom:Math.floor((b.value-y.value-v.value)/n[1])*n[1]+v.value}}function _(o){const a=o.target||o.srcElement;t.eleRef.value&&!t.eleRef.value.contains(a)&&p.value&&!e.preventDeactivation&&(p.value=!1,n("deactivated"),n("update:active",!1))}function R(t){f.value&&function(t){const o=e.axis,a=e.grid;let l=0,d=0;t instanceof MouseEvent?(l=t.pageX,d=t.pageY):(l=t.touches[0].pageX,d=t.touches[0].pageY);const r=o&&"y"!==o?x.mouseX-l:0,s=o&&"x"!==o?x.mouseY-d:0,{deltaX:i,deltaY:p}=de(a,r,s,e.scale),f=re(x.left-i,S.minLeft,S.maxLeft),g=re(x.top-p,S.minTop,S.maxTop),y=re(x.right+i,S.minRight,S.maxRight),h=re(x.bottom+p,S.minBottom,S.maxBottom);u.value=f,c.value=g,m.value=y,v.value=h,n("dragging",u.value,c.value)}(t)}function F(){C(),f.value&&(f.value=!1,n("dragstop",u.value,c.value))}z((()=>{C()})),N((()=>{!e.enableNativeDrag&&t.eleRef.value&&(t.eleRef.value.ondragstart=()=>!1);const[n,o]=k();if(h.value=n,b.value=o,t.eleRef.value){const[e,n]=function(e){const n=window.getComputedStyle(e);return[parseFloat(n.getPropertyValue("width")),parseFloat(n.getPropertyValue("height"))]}(t.eleRef.value);g.value=e,y.value=n,m.value=h.value-g.value-u.value,v.value=b.value-y.value-c.value}se(document.documentElement,"mousedown",_),se(document.documentElement,"touchend touchcancel",_),se(window,"resize",M)})),D((()=>{ue(document.documentElement,"mousedown",_),ue(document.documentElement,"touchstart",F),ue(document.documentElement,"mousemove",R),ue(document.documentElement,"touchmove",R),ue(document.documentElement,"mouseup",F),ue(document.documentElement,"touchend touchcancel",_),ue(window,"resize",M)}));const A=$((()=>({transform:`translate(${u.value}px, ${c.value}px)`,zIndex:i.value,...f.value&&e.disableUserSelect?l:d})));return E((()=>e.active),(e=>{p.value=e,n(e?"activated":"deactivated")})),E((()=>e.z),(e=>{(e>=0||"auto"===e)&&(i.value=e)})),E((()=>e.x),(n=>{f.value||(e.parent&&(S=w()),function(n){const{deltaX:t}=de(e.grid,n,c.value,e.scale),o=re(t,S.minLeft,S.maxLeft);u.value=o,m.value=h.value-g.value-o}(n))})),E((()=>e.y),(n=>{f.value||(e.parent&&(S=w()),function(n){const{deltaY:t}=de(e.grid,u.value,n,e.scale),o=re(t,S.minTop,S.maxTop);c.value=o,v.value=b.value-y.value-o}(n))})),{enabled:p,dragging:f,style:A,resetBoundsAndMouseState:C,elementTouchDown:function(e){s=a,O(e)},elementMouseDown:function(e){s=o,O(e)}}})(e,n,{eleRef:t});return{top:top,eleRef:t,...o}}});me.render=function(e,o,a,d,r,c){return n(),t("div",{style:u(e.style),class:l([{[e.classNameActive]:e.enabled,[e.classNameDragging]:e.dragging,[e.classNameDraggable]:e.draggable},e.className]),ref:"eleRef",onMousedown:o[0]||(o[0]=(...n)=>e.elementMouseDown&&e.elementMouseDown(...n)),onTouchstart:o[1]||(o[1]=(...n)=>e.elementTouchDown&&e.elementTouchDown(...n))},[s(e.$slots,"default")],38)},me.__file="src/components/draggable/src/draggable.vue";var ve=d({components:{TreeOrgNode:I},props:pe({data:{type:Object,required:!0},props:{type:fe(Object)},modelValue:Boolean,horizontal:Boolean,selectedKey:String,collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]}}),setup:(e,n)=>({defaultSlot:!!n.slots.default,expandSlot:!!n.slots.expand})});ve.render=function(t,o,a,d,r,u){const h=c("tree-org-node");return n(),i(y,{to:"body"},[p(e("div",{id:"clone-tree-org",class:l(["clone-tree-org tree-org",{horizontal:t.horizontal,collapsable:t.collapsable}])},[m(h,{data:t.data,props:t.props,isClone:!1,horizontal:t.horizontal,labelStyle:t.labelStyle,collapsable:t.collapsable,renderContent:t.renderContent,labelClassName:t.labelClassName},v({_:2},[t.defaultSlot?{name:"default",fn:g((({node:e})=>[s(t.$slots,"default",{node:e})]))}:void 0,t.expandSlot?{name:"expand",fn:g((({node:e})=>[s(t.$slots,"expand",{node:e})]))}:void 0]),1032,["data","props","horizontal","labelStyle","collapsable","renderContent","labelClassName"])],2),[[f,t.modelValue]])])},ve.__file="src/components/clone-org/clone-org.vue";const ge=(e,{emit:n},t)=>{const o=r("");function a(e,n,t){if(e[n.id]===t)return e;if(Array.isArray(e[n.children])){const o=e[n.children];for(let e=0,l=o.length;e<l;e++){const l=a(o[e],n,t);if(l)return l}}}function l(){const{props:t,data:o,node:l}=e;if(e.nodeDelete)return void e.nodeDelete(l.$$data);if(l.$$root)return void B.pretty("[提示] ","根节点不允许删除","danger");const{id:d,children:r}=t,s=a(o,t,l.pid);if(s){const e=s[r];for(let t=0,o=e.length;t<o;t++)if(e[t][d]===l.id){e.splice(t,1),n("onNodeDelete",l.$$data,l);break}}}function d(){const{nodeEdit:t,node:o}=e;t?t(o.$$data):(o.$$focused=!0,n("onNodeFocus",o.$$data))}function s(o){if(e.modelValue){if(t.eleRef.value&&t.eleRef.value.contains(o.target))return!1;n("update:modelValue",!1)}}const u=$((()=>({left:`${e.x}px`,top:`${e.y}px`}))),c=$((()=>!e.disabled&&!e.node.disabled));return N((()=>{document.addEventListener("mousedown",s)})),D((()=>{document.removeEventListener("mousedown",s)})),{position:u,editable:c,handleMenu:function(a){const r=a.target;if("zm-tree-menu-item"===r.className){const a=r.getAttribute("action");switch(a){case"copy":e.nodeCopy?e.nodeCopy(e.node.$$data):(o.value=e.node.label,C((()=>{t.inputRef&&t.inputRef.value&&(t.inputRef&&t.inputRef.value.select(),navigator.clipboard.writeText(o.value).then((function(){B.pretty("[提示] ","文本复制成功","success")}),(function(){B.pretty("[错误] ","浏览器不支持","danger")})),n("onNodeCopy",o.value))})));break;case"add":!function(){if(e.nodeAdd)return void e.nodeAdd(e.node.$$data);const{id:t,pid:o,label:a,expand:l,children:d}=e.props,{node:r}=e,s={[t]:String((new Date).getTime()),[o]:r.id,[a]:"",[l]:!1,[d]:[],newNode:!0,focused:!0};Array.isArray(r.children)?r.$$data[d].push(s):r.$$data[d]=[s],n("onNodeFocus",s)}();break;case"edit":d();break;case"delete":l()}n("contextmenu",{command:a,node:e.node,data:e.node.$$data}),n("update:modelValue",!1)}},handleEdit:d,handleClose:s,afterEnter:function(){n("opened")},afterLeave:function(){n("closed")}}};var ye=d({name:"Contextmenu",props:pe({modelValue:{type:Boolean,required:!0},data:{type:Object,required:!0},node:{type:fe(Object),required:!0},props:{type:fe(Object)},x:Number,y:Number,menus:{type:fe(Array)},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,disabled:Boolean}),emits:{onNodeDelete:(e,n)=>R(e)&&R(n),onNodeCopy:e=>F(e),contextmenu:e=>R(e),onNodeFocus:e=>R(e),opened:()=>!0,closed:()=>!0,"update:modelValue":e=>"boolean"==typeof e},setup(e,n){const t=r(),o=r();return{eleRef:o,inputRef:t,copyText:r(""),oldData:h({}),...ge(e,n,{inputRef:t,eleRef:o})}}});const he=["action"];ye.render=function(l,d,r,s,c,v){return n(),i(y,{to:"body"},[m(b,{name:"dialog-fade",onAfterEnter:l.afterEnter,onAfterLeave:l.afterLeave,persisted:""},{default:g((()=>[p(e("div",{style:u(l.position),onClick:d[1]||(d[1]=(...e)=>l.handleMenu&&l.handleMenu(...e)),ref:"eleRef",class:"zm-tree-contextmenu"},[e("ul",null,[(n(!0),t(k,null,M(l.menus,(e=>(n(),t(k,null,[l.editable||!["add","edit","delete"].includes(e.command)?(n(),t("li",{class:"zm-tree-menu-item",action:e.command,key:e.command},o(e.name),9,he)):a("v-if",!0)],64)))),256))]),p(e("textarea",{class:"copy-textarea",ref:"inputRef","onUpdate:modelValue":d[0]||(d[0]=e=>l.copyText=e)},null,512),[[O,l.copyText]])],4),[[f,l.modelValue]])])),_:1},8,["onAfterEnter","onAfterLeave"])])},ye.__file="src/components/contextmenu/src/contextmenu.vue";const be=[{name:"复制文本",command:"copy"},{name:"新增节点",command:"add"},{name:"编辑节点",command:"edit"},{name:"删除节点",command:"delete"}],xe=pe({data:{type:Object,required:!0},center:Boolean,props:{type:fe(Object),default:()=>({id:"id",pid:"pid",label:"label",expand:"expand",children:"children"})},toolBar:{type:[Object,Boolean],default:()=>({expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0})},disabled:{type:Boolean,default:!1},scalable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},draggableOnNode:{type:Boolean,default:!1},nodeDraggable:{type:Boolean,default:!0},cloneNodeDrag:{type:Boolean,default:!0},onlyOneNode:{type:Boolean,default:!0},clickDelay:{type:Number,default:260},lazy:Boolean,load:{type:fe(Function)},defaultExpandLevel:Number,defaultExpandKeys:{type:Array,default:()=>[]},beforeDragEnd:Function,horizontal:Boolean,selectedKey:{type:[Array,String,Number]},collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]},selectedClassName:{type:[Function,String]},defineMenus:{type:fe([Array,Function]),default:()=>be},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,filterNodeMethod:Function}),$e=(e,{emit:n},t)=>{const o=r(0),a=r(0),l=r(!1);function d(n,l){const d=t.zoomRef.value,r=t.treeRef.value;let s=d.clientWidth/2;const u=d.clientHeight/2;let c=d.clientHeight-r.clientHeight,i=d.clientWidth-r.clientWidth;if(c>0&&(c=0),i>0&&(i=0),e.center){const e=(d.clientWidth-r.clientWidth)/2;i-=e,s-=e}o.value=n>s?s:n<i?i:n,a.value=l<c?c:l>u?u:l}function s(e,t){d(e,t),setTimeout((()=>{T.set(!1)}),200),n("on-drag-stop",{x:e,y:t})}const u=r(!1),c=h({value:{}}),i=r(!1),p=r(0),f=r(0),m=r({}),v=r([]),g=r(1);function y(n){if(!e.scalable)return;const t=Number((Number(g.value)+n).toFixed(1));g.value=n>0?Math.min(3,t):Math.max(.3,t)}function b(n,t,r){if(l.value=!0,!e.center||e.horizontal){const e=n.offsetLeft-t;o.value-=e}const s=n.offsetTop-r;a.value-=s,d(o.value,a.value)}let x;const N=h(Object.assign({id:"id",pid:"pid",label:"label",expand:"expand",children:"children",isLeaf:"isLeaf"},e.props)),S=r(!1);function D(e){e.forEach((e=>{e.expand&&(e.expand=!1,j.delete(e.id)),e.children&&D(e.children)}))}const M=r(!1);function k(e,n){Array.isArray(e)?e.forEach((e=>{n&&j.add(e.id),e.expand=n,n&&j.add(e.id),e.children&&k(e.children,n)})):(n&&j.add(e.id),e.expand=n,n&&j.add(e.id),e.children&&k(e.children,n))}function O(e){V.value=P(e)}const w=$((()=>({width:100/g.value+"%",height:100/g.value+"%",transform:`scale(${g.value})`}))),_=$((()=>`${Math.round(100*g.value)}%`)),R=$((()=>e.draggableOnNode&&!e.nodeDraggable?"":`.tree-org-node__content:not(.is-root_${Y})>.tree-org-node__inner`)),F=$((()=>M.value?"收起全部节点":"展开全部节点")),A=$((()=>M.value?"收起全部节点":"展开全部节点")),B=r({}),L=$((()=>{const{cloneNodeDrag:t,onlyOneNode:o,data:a}=e;return{drag:e.nodeDraggable,dragData:{keys:N,nodeMoving:u,stopClick:T,parenNode:c,cloneNodeDrag:t,onlyOneNode:o,contextmenu:i,cloneData:B,data:a},beforeDragEnd:e.beforeDragEnd,initNodes:P,emit:n}}));E((()=>e.horizontal),(()=>{C((()=>{s(o.value,a.value)}))}));let j=new Set(e.defaultExpandKeys);function P(n){const{defaultExpandLevel:t=0}=e,o=(e,n)=>{const{id:a,label:l,pid:d,expand:r,children:s,isLeaf:u}=N,c={};Object.keys(e).map((n=>{["hidden","disabled","className","style"].includes(n)&&(c[n]=e[n])}));const i=e[s],p=n+1,f=e[r],m=e[a];return(f||void 0===f&&n<t)&&j.add(m),{...c,id:m,label:e[l],pid:e[d],expand:j.has(m),children:i?i.map((e=>o(e,p))):void 0,isLeaf:e[u],$$level:n,$$data:e,$$focused:e.focused||!1}};return o(n,0)}const V=r(P(e.data));E((()=>e.data),((n,t)=>{n!==t&&(j=new Set(e.defaultExpandKeys)),O(e.data)}),{deep:!0});const X=h({visible:!0,data:{expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0}});z((()=>{"object"==typeof e.toolBar?Object.assign(X.data,e.toolBar):e.toolBar||(X.visible=!1)}));const Y=function(e){e=e||32;const n="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";let t="";for(let o=0;o<e;o++)t+=n.charAt(Math.floor(48*Math.random()));return t}(6);return{keys:N,left:o,top:a,menuX:p,menuY:f,suffix:Y,nodeMoving:u,zoomStyle:w,tools:X,zoomPercent:_,dragCancel:R,expandTitle:F,fullTiltle:A,nodeargs:L,expanded:M,fullscreen:S,treeData:V,autoDragging:l,contextmenu:i,nodeMenus:v,menuData:m,cloneData:B,filter:function(n){const t=e.filterNodeMethod;if(!t)throw new Error("[Tree] filterNodeMethod is required when filter");const o=function(e){const a=e.children||[];if(a.forEach((e=>{e.$$hidden=!t.call(e,n,e),o(e)})),e.$$hidden&&a.length){let n=!0;n=a.some((e=>!e.$$hidden)),e.$$hidden=!n}n&&!e.$$hidden&&e.children&&(e.expand=!0)};o(V.value)},setData:O,zoomWheel:function(t){e.scalable&&(t.preventDefault(),t.deltaY<0?y(.1):y(-.1),n("on-zoom",g.value))},onDrag:function(e,t){T.set(!0),l.value=!1,o.value=e,a.value=t,n("on-drag",{x:e,y:t})},onDragStop:s,expandChange:function(){M.value=!M.value,M.value||(j.clear(),C((()=>{s(o.value,a.value)}))),k(V.value,M.value),n("on-expand-all",M.value)},handleFullscreen:function(e){S.value=!S.value,"esc"!==e&&(S.value?function(){const e=t.eleRef.value;e.requestFullscreen&&e.requestFullscreen()}():document.exitFullscreen&&document.exitFullscreen())},zoomOrgchart:y,restoreOrgchart:function(){g.value=1,o.value=0,a.value=0,n("on-restore")},handleExpand:function(t,o){t.stopPropagation();const a=document.querySelector(`.is-root_${Y}`);if(a){const d=a.offsetLeft,r=a.offsetTop;o.expand=!o.expand;let s=!0;o.expand?(j.add(o.id),e.lazy&&e.load&&(s=!1,l=o,(0,e.load)(l,((e,n)=>{const{children:t}=N;l.isLeaf=!e.length,e.length&&(l.$$data[t]=e,n&&C((()=>{b(a,d,r)})))})))):!o.expand&&o.children&&(j.delete(o.id),D(o.children)),C((()=>{s&&b(a,d,r)})),n("on-expand",t,o.$$data,o)}var l},getExpandKeys:function(){return[...j]},setExpandKeys:function(n){j=new Set(n),O(e.data)},nodeMouseenter:function(e,t){return u.value&&(c.value=t),n("on-node-mouseenter",e,t.$$data,t),!0},nodeMouseleave:function(e,t){return u.value&&(c.value=null),n("on-node-mouseleave",e,t.$$data,t),!0},nodeContextmenu:function(n,t){n.stopPropagation(),n.preventDefault();const{defineMenus:o}=e;Array.isArray(o)?v.value=o:"function"==typeof o&&(v.value=o(n,t)||[]),i.value=!0,p.value=n.clientX,f.value=n.clientY,m.value=t},handleFocus:function(e,t,o){n("on-node-focus",e,t,o)},handleBlur:function(e,t,o){const{id:a,label:l}=N,d=m.value.children||[];for(let n=d.length;n>0;n--){const e=d[n-1];if(""===e[a]&&""===e[l]){d.splice(n-1,1);break}}n("on-node-blur",e,t,o)},handleClick:function(t,o){T.get()||(clearTimeout(x),x=setTimeout((()=>{n("on-node-click",t,o.$$data,o)}),e.clickDelay))},handleDblclick:function(e,t){clearTimeout(x),n("on-node-dblclick",e,t.$$data,t)}}};var Ne=d({name:"vue3TreeOrg",components:{Tools:J,CloneOrg:ve,Draggable:me,Contextmenu:ye,TreeOrgNode:I},directives:{nodedrag:V},props:xe,emits:{"on-drag":({x:e,y:n})=>A(e)&&A(n),"on-drag-stop":({x:e,y:n})=>A(e)&&A(n),"on-restore":()=>!0,"on-zoom":e=>A(e),"on-expand":(e,n,t)=>e instanceof MouseEvent&&R(t)&&R(n),"on-expand-all":e=>"boolean"==typeof e,"on-node-blur":(e,n,t)=>e instanceof FocusEvent&&R(t)&&R(n),"on-node-click":(e,n,t)=>e instanceof MouseEvent&&R(t)&&R(n),"on-node-dblclick":(e,n,t)=>e instanceof MouseEvent&&R(t)&&R(n),"on-node-mouseenter":(e,n,t)=>e instanceof MouseEvent&&R(t)&&R(n),"on-node-mouseleave":(e,n,t)=>e instanceof MouseEvent&&R(t)&&R(n),"on-contextmenu":e=>R(e),"on-node-copy":e=>F(e),"on-node-delete":e=>R(e),"on-node-drag-start":e=>R(e),"on-node-drag":e=>R(e),"on-node-drag-end":(e,n)=>R(e)&&R(n),"on-node-focus":(e,n,t)=>e instanceof FocusEvent&&R(t)&&R(n)},setup(e,n){const t=!!n.slots.default,o=!!n.slots.expand,a=r(),l=r(),d=r();return{eleRef:a,treeRef:l,zoomRef:d,defaultSlot:t,expandSlot:o,...$e(e,n,{eleRef:a,treeRef:l,zoomRef:d})}}});const Se={ref:"eleRef",class:"zm-tree-org"},ze={class:"tree-org-node__text"},De=e("span",{class:"tree-org-node__expand-btn"},null,-1),Ee={class:"tree-org-node__text"},Ce=e("span",{class:"tree-org-node__expand-btn"},null,-1);Ne.render=function(d,r,p,f,y,h){const b=c("tree-org-node"),x=c("Draggable"),$=c("Tools"),N=c("clone-org"),S=c("Contextmenu");return n(),t("div",Se,[e("div",{ref:"zoomRef",class:l(["zoom-container",{"is-center":d.center&&!d.horizontal}]),style:u(d.zoomStyle),onWheel:r[0]||(r[0]=(...e)=>d.zoomWheel&&d.zoomWheel(...e))},[m(x,{x:d.left,y:d.top,class:l({dragging:d.autoDragging}),onDragging:d.onDrag,onDragstop:d.onDragStop,draggable:d.draggable,"drag-cancel":d.dragCancel},{default:g((()=>[e("div",{ref:"treeRef",class:l(["tree-org",{horizontal:d.horizontal,collapsable:d.collapsable}])},[m(b,{data:d.treeData,props:d.keys,lazy:d.lazy,suffix:d.suffix,horizontal:d.horizontal,labelStyle:d.labelStyle,collapsable:d.collapsable,renderContent:d.renderContent,selectedKey:d.selectedKey,defaultExpandLevel:d.defaultExpandLevel,selectedClassName:d.selectedClassName,labelClassName:d.labelClassName,vNodedrag:d.nodeargs,onOnExpand:d.handleExpand,onNodeClick:d.handleClick,onNodeDblclick:d.handleDblclick,onNodeMouseenter:d.nodeMouseenter,onNodeMouseleave:d.nodeMouseleave,onNodeContextmenu:d.nodeContextmenu,onNodeFocus:d.handleFocus,onNodeBlur:d.handleBlur},v({_:2},[d.defaultSlot?{name:"default",fn:g((({node:n})=>[s(d.$slots,"default",{node:n},(()=>[e("div",ze,[e("span",null,o(n.label),1)])]))]))}:void 0,d.expandSlot?{name:"expand",fn:g((({node:e})=>[s(d.$slots,"expand",{node:e},(()=>[De]))]))}:void 0]),1032,["data","props","lazy","suffix","horizontal","labelStyle","collapsable","renderContent","selectedKey","defaultExpandLevel","selectedClassName","labelClassName","vNodedrag","onOnExpand","onNodeClick","onNodeDblclick","onNodeMouseenter","onNodeMouseleave","onNodeContextmenu","onNodeFocus","onNodeBlur"])],2)])),_:3},8,["x","y","class","onDragging","onDragstop","draggable","drag-cancel"])],38),d.tools.visible?(n(),i($,{key:0,tools:d.tools.data,scale:d.zoomPercent,onOnExpand:d.expandChange,onOnScale:d.zoomOrgchart,onOnRestore:d.restoreOrgchart,onOnFullscreen:d.handleFullscreen},null,8,["tools","scale","onOnExpand","onOnScale","onOnRestore","onOnFullscreen"])):a("v-if",!0),d.nodeDraggable?(n(),i(N,{key:1,modelValue:d.nodeMoving,"onUpdate:modelValue":r[1]||(r[1]=e=>d.nodeMoving=e),props:d.keys,data:d.cloneData,horizontal:d.horizontal,"label-style":d.labelStyle,collapsable:d.collapsable,"render-content":d.renderContent,"label-class-name":d.labelClassName},v({_:2},[d.defaultSlot?{name:"default",fn:g((({node:n})=>[s(d.$slots,"default",{node:n},(()=>[e("div",Ee,[e("span",null,o(n[d.keys.label]),1)])]))]))}:void 0,d.expandSlot?{name:"expand",fn:g((({node:e})=>[s(d.$slots,"expand",{node:e},(()=>[Ce]))]))}:void 0]),1032,["modelValue","props","data","horizontal","label-style","collapsable","render-content","label-class-name"])):a("v-if",!0),d.nodeMenus.length?(n(),i(S,{key:2,modelValue:d.contextmenu,"onUpdate:modelValue":r[2]||(r[2]=e=>d.contextmenu=e),x:d.menuX,y:d.menuY,node:d.menuData,data:d.data,props:d.keys,menus:d.nodeMenus,disabled:d.disabled,"node-add":d.nodeAdd,"node-delete":d.nodeDelete,"node-edit":d.nodeEdit,"node-copy":d.nodeCopy,onContextmenu:r[3]||(r[3]=e=>{d.$emit("on-contextmenu",e)}),onOnNodeCopy:r[4]||(r[4]=e=>{d.$emit("on-node-copy",e)}),onOnNodeDelete:r[5]||(r[5]=e=>{d.$emit("on-node-delete",e)})},null,8,["modelValue","x","y","node","data","props","menus","disabled","node-add","node-delete","node-edit","node-copy"])):a("v-if",!0)],512)},Ne.__file="src/components/tree-org/src/tree.vue",Ne.install=function(e){e.component(Ne.name,Ne)};const Me=[Ne];var ke={install:function(e){Me.forEach((n=>{e.component(n.name,n)})),e.use(L)},Vue3TreeOrg:Ne};export{ke as R};

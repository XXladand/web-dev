import{o as t,c as e,a as s,J as i,K as r,U as a,S as h,a3 as o}from"./@vue-CX_mlhJe.js";import{_ as n}from"./_plugin-vue_export-helper-BCo6x5W8.js";const g={name:"dragVerify",props:{isPassing:{type:Boolean,default:!1},width:{type:Number,default:250},height:{type:Number,default:40},text:{type:String,default:"swiping to the right side"},successText:{type:String,default:"success"},background:{type:String,default:"#eee"},progressBarBg:{type:String,default:"#76c61d"},completedBg:{type:String,default:"#76c61d"},circle:{type:Boolean,default:!1},radius:{type:String,default:"4px"},handlerIcon:{type:String},successIcon:{type:String},handlerBg:{type:String,default:"#fff"},textSize:{type:String,default:"14px"},textColor:{type:String,default:"#333"},imgsrc:{type:String},showTips:{type:Boolean,default:!0},successTip:{type:String,default:"验证通过"},failTip:{type:String,default:"验证失败"},diffDegree:{type:Number,default:10},minDegree:{type:Number,default:90},maxDegree:{type:Number,default:270}},mounted:function(){const t=this.$refs.dragVerify;t.style.setProperty("--textColor",this.textColor),t.style.setProperty("--width",Math.floor(this.width/2)+"px"),t.style.setProperty("--pwidth",-Math.floor(this.width/2)+"px")},computed:{handlerStyle:function(){return{width:this.height+"px",height:this.height+"px",background:this.handlerBg}},message:function(){return this.isPassing?"":this.text},successMessage:function(){return this.isPassing?this.successText:""},dragVerifyStyle:function(){return{width:this.width+"px",height:this.height+"px",lineHeight:this.height+"px",marginTop:"20px",background:this.background,borderRadius:this.circle?this.height/2+"px":this.radius}},dragVerifyImgStyle:function(){return{width:this.width+"px",height:this.width+"px",position:"relative",overflow:"hidden","border-radius":"50%"}},progressBarStyle:function(){return{background:this.progressBarBg,height:this.height+"px",borderRadius:this.circle?this.height/2+"px 0 0 "+this.height/2+"px":this.radius}},textStyle:function(){return{height:this.height+"px",width:this.width+"px",fontSize:this.textSize}},factor:function(){return this.minDegree==this.maxDegree?Math.floor(1+6*Math.random())/10+1:1}},data:()=>({isMoving:!1,x:0,isOk:!1,showBar:!1,showErrorTip:!1,ranRotate:0,cRotate:0,imgStyle:{}}),methods:{checkimgLoaded:function(){var t=this.minDegree,e=this.maxDegree,s=Math.floor(t+Math.random()*(e-t));this.ranRotate=s,this.imgStyle={transform:`rotateZ(${s}deg)`}},dragStart:function(t){this.isPassing||(this.isMoving=!0,this.x=t.pageX||t.touches[0].pageX),this.showBar=!0,this.showErrorTip=!1,this.$emit("handlerMove")},dragMoving:function(t){if(this.isMoving&&!this.isPassing){var e=(t.pageX||t.touches[0].pageX)-this.x;this.$refs.handler.style.left=e+"px",this.$refs.progressBar.style.width=e+this.height/2+"px";var s=Math.ceil(e/(this.width-this.height)*this.maxDegree*this.factor);this.cRotate=s;var i=this.ranRotate-s;this.imgStyle={transform:`rotateZ(${i}deg)`}}},dragFinish:function(t){if(this.isMoving&&!this.isPassing){if(Math.abs(this.ranRotate-this.cRotate)>this.diffDegree){this.isOk=!0,this.imgStyle={transform:`rotateZ(${this.ranRotate}deg)`};var e=this;setTimeout((function(){e.$refs.handler.style.left="0",e.$refs.progressBar.style.width="0",e.isOk=!1}),500),this.showErrorTip=!0,this.$emit("passfail")}else this.passVerify();this.isMoving=!1}},passVerify:function(){this.$emit("update:isPassing",!0),this.isMoving=!1,this.$refs.handler.children[0].className=this.successIcon,this.$refs.progressBar.style.background=this.completedBg,this.$refs.message.style["-webkit-text-fill-color"]="unset",this.$refs.message.style.animation="slidetounlock2 3s infinite",this.$refs.progressBar.style.color="#fff",this.$refs.progressBar.style.fontSize=this.textSize,this.$emit("passcallback")},reset:function(){this.reImg(),this.checkimgLoaded()},reImg:function(){this.$emit("update:isPassing",!1);const t=this.$options.data();for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(this[i]=t[i]);var e=this.$refs.handler,s=this.$refs.message;e.style.left="0",this.$refs.progressBar.style.width="0",e.children[0].className=this.handlerIcon,s.style["-webkit-text-fill-color"]="transparent",s.style.animation="slidetounlock 3s infinite",s.style.color=this.background},refreshimg:function(){this.$emit("refresh")}},watch:{imgsrc:{immediate:!1,handler:function(){this.reImg()}}}},d={class:"drag-verify-container"},l=["src"],c={key:0,class:"tips success"},f={key:1,class:"tips danger"};const p=n(g,[["render",function(n,g,p,u,y,m){return t(),e("div",d,[s("div",{style:r([m.dragVerifyImgStyle,{"background-color":"var(--el-color-primary)"}])},[s("img",{ref:"checkImg",src:p.imgsrc,class:i(["check-img",{goOrigin:y.isOk}]),onLoad:g[0]||(g[0]=(...t)=>m.checkimgLoaded&&m.checkimgLoaded(...t)),style:r(y.imgStyle),alt:""},null,46,l),p.showTips&&p.isPassing?(t(),e("div",c,a(p.successTip),1)):h("",!0),p.showTips&&!p.isPassing&&y.showErrorTip?(t(),e("div",f,a(p.failTip),1)):h("",!0)],4),s("div",{ref:"dragVerify",class:"drag_verify",style:r(m.dragVerifyStyle),onMousemove:g[3]||(g[3]=(...t)=>m.dragMoving&&m.dragMoving(...t)),onMouseup:g[4]||(g[4]=(...t)=>m.dragFinish&&m.dragFinish(...t)),onMouseleave:g[5]||(g[5]=(...t)=>m.dragFinish&&m.dragFinish(...t)),onTouchmove:g[6]||(g[6]=o(((...t)=>m.dragMoving&&m.dragMoving(...t)),["prevent"])),onTouchend:g[7]||(g[7]=o(((...t)=>m.dragFinish&&m.dragFinish(...t)),["prevent"]))},[s("div",{class:i(["dv_progress_bar",{goFirst2:y.isOk}]),ref:"progressBar",style:r(m.progressBarStyle)},a(m.successMessage),7),s("div",{class:"dv_text",style:r(m.textStyle),ref:"message"},a(m.message),5),s("div",{class:i(["dv_handler dv_handler_bg",{goFirst:y.isOk}]),onMousedown:g[1]||(g[1]=(...t)=>m.dragStart&&m.dragStart(...t)),onTouchstart:g[2]||(g[2]=o(((...t)=>m.dragStart&&m.dragStart(...t)),["prevent"])),ref:"handler",style:r([m.handlerStyle,{"background-color":"var(--el-color-primary)"}])},[s("i",{class:i(p.handlerIcon),style:{color:"#FFF"}},null,2)],38)],36)])}],["__scopeId","data-v-355dae2c"]]);export{p as default};

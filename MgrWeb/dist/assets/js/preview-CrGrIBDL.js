import{d as e,_ as i,r as t,ah as a,o as r,O as n,P as l,V as o,T as p,a3 as s,a as d,n as m}from"./@vue-CX_mlhJe.js";import{_ as h}from"./_plugin-vue_export-helper-BCo6x5W8.js";const u=h(e({__name:"preview",setup(e,{expose:h}){const u=i({dialogVisible:!1,waitShowPrinter:!1,width:0,printData:{},printType:1,printParam:{printer:"",title:"",color:!1,copies:1},hiprintTemplate:{}}),c=t(),w=()=>{if(u.waitShowPrinter=!0,2==u.printType){u.hiprintTemplate.getPrinterList().some((e=>e.name==u.printParam.printer))?(u.hiprintTemplate.print2(u.printData,u.printParam),u.hiprintTemplate.on("printSuccess",(function(e){u.waitShowPrinter=!1})),u.hiprintTemplate.on("printError",(function(e){u.waitShowPrinter=!1,alert("打印失败："+e)}))):alert("打印机不存在")}else u.hiprintTemplate.print(u.printData,{},{callback:()=>{u.waitShowPrinter=!1}})},f=()=>{u.hiprintTemplate.toPdf(u.printData,"PDF文件")},P=()=>{u.dialogVisible=!1};return h({showDialog:(e,i,t=210,a=1,r)=>{u.dialogVisible=!0,u.width=t,u.hiprintTemplate=e,u.printData=i,u.printParam=r,u.printType=a,m((()=>{for(var t;null==(t=c.value)?void 0:t.firstChild;)c.value.removeChild(c.value.firstChild);const a=e.getHtml(i);c.value.appendChild(a[0])}))}}),(e,i)=>{const t=a("el-button"),m=a("el-dialog");return r(),n(m,{modelValue:u.dialogVisible,"onUpdate:modelValue":i[0]||(i[0]=e=>u.dialogVisible=e),draggable:"","close-on-click-modal":!1,width:Number(u.width)+Number(8)+"mm"},{footer:l((()=>[o(t,{loading:u.waitShowPrinter,type:"primary",icon:"ele-Printer",onClick:s(w,["stop"])},{default:l((()=>[p("直接打印")])),_:1},8,["loading"]),o(t,{type:"primary",icon:"ele-Printer",onClick:s(f,["stop"])},{default:l((()=>[p("导出PDF")])),_:1}),o(t,{key:"close",onClick:P},{default:l((()=>[p(" 关闭 ")])),_:1})])),default:l((()=>[d("div",{id:"preview_content",ref_key:"previewContentRef",ref:c},null,512)])),_:1},8,["modelValue","width"])}}}),[["__scopeId","data-v-63ae42e3"]]);export{u as default};

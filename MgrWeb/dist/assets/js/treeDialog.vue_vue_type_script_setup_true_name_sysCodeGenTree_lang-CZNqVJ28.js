import{g as l}from"./index-DWGcUZYU.js";import{S as e}from"./sys-code-gen-api-BI7DgiUl.js";import{d as a,r as o,_ as m,j as u,ah as t,o as n,c as s,V as d,P as r,a as i,T as c,F as f,a8 as b,O as p}from"./@vue-CX_mlhJe.js";const g={class:"sys-codeGenTree-container"},y={style:{color:"#fff"}},C=i("span",null," 树选择配置 ",-1),F={class:"dialog-footer"},v=a({name:"sysCodeGenTree"}),N=a({...v,emits:["submitRefreshFk"],setup(a,{expose:v,emit:N}){var _={};const D=N,w=o(),V=m({isShowDialog:!1,ruleForm:{},dbData:[],tableData:[],columnData:[]});u((async()=>{await h()}));const h=async()=>{var a=await l(e).apiSysCodeGenDatabaseListGet();V.dbData=a.data.result},x=async()=>{if(""!=V.ruleForm.configId){var a=await l(e).apiSysCodeGenTableListConfigIdGet(V.ruleForm.configId);V.tableData=a.data.result}},k=async()=>{if(""!=V.ruleForm.configId&&""!=V.ruleForm.tableName){var a=await l(e).apiSysCodeGenColumnListByTableNameTableNameConfigIdGet(V.ruleForm.tableName,V.ruleForm.configId);V.columnData=a.data.result}},I=()=>{V.isShowDialog=!1},S=()=>{w.value.validate((async l=>{l&&(()=>{_.fkTableName=V.ruleForm.tableName;let l=V.tableData.filter((l=>l.tableName==V.ruleForm.tableName));_.fkEntityName=0==l.length?"":l[0].entityName,_.displayColumn=V.ruleForm.displayColumn,_.valueColumn=V.ruleForm.valueColumn,_.pidColumn=V.ruleForm.pidColumn,D("submitRefreshFk",_),V.isShowDialog=!1})()}))};return v({openDialog:l=>{var e;_=l,V.isShowDialog=!0,null==(e=w.value)||e.resetFields()}}),(l,e)=>{const a=t("ele-Edit"),o=t("el-icon"),m=t("el-option"),u=t("el-select"),v=t("el-form-item"),N=t("el-col"),_=t("el-row"),D=t("el-form"),h=t("el-button"),G=t("el-dialog");return n(),s("div",g,[d(G,{modelValue:V.isShowDialog,"onUpdate:modelValue":e[7]||(e[7]=l=>V.isShowDialog=l),draggable:"","close-on-click-modal":!1,width:"700px"},{header:r((()=>[i("div",y,[d(o,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:r((()=>[d(a)])),_:1}),C])])),footer:r((()=>[i("span",F,[d(h,{onClick:I},{default:r((()=>[c("取 消")])),_:1}),d(h,{type:"primary",onClick:S},{default:r((()=>[c("确 定")])),_:1})])])),default:r((()=>[d(D,{model:V.ruleForm,ref_key:"ruleFormRef",ref:w,"label-width":"auto"},{default:r((()=>[d(_,{gutter:35},{default:r((()=>[d(N,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:r((()=>[d(v,{label:"库定位器",prop:"configId"},{default:r((()=>[d(u,{clearable:"",modelValue:V.ruleForm.configId,"onUpdate:modelValue":e[0]||(e[0]=l=>V.ruleForm.configId=l),placeholder:"库名",filterable:"",onChange:e[1]||(e[1]=l=>(async()=>{V.tableData=[],V.columnData=[],await x()})()),class:"w100"},{default:r((()=>[(n(!0),s(f,null,b(V.dbData,(l=>(n(),p(m,{key:l.configId,label:l.configId,value:l.configId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(N,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:r((()=>[d(v,{label:"数据库表",prop:"tableName"},{default:r((()=>[d(u,{modelValue:V.ruleForm.tableName,"onUpdate:modelValue":e[2]||(e[2]=l=>V.ruleForm.tableName=l),class:"w100",filterable:"",clearable:"",onChange:e[3]||(e[3]=l=>(async()=>{V.columnData=[],await k()})())},{default:r((()=>[(n(!0),s(f,null,b(V.tableData,(l=>(n(),p(m,{key:l.entityName,label:l.tableName+" ["+l.tableComment+"]",value:l.tableName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(N,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:r((()=>[d(v,{label:"显示字段",prop:"displayColumn"},{default:r((()=>[d(u,{modelValue:V.ruleForm.displayColumn,"onUpdate:modelValue":e[4]||(e[4]=l=>V.ruleForm.displayColumn=l),class:"w100"},{default:r((()=>[(n(!0),s(f,null,b(V.columnData,(l=>(n(),p(m,{key:l.columnName,label:l.columnName+" ["+l.columnComment+"]",value:l.columnName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(N,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:r((()=>[d(v,{label:"选择值字段",prop:"valueColumn"},{default:r((()=>[d(u,{modelValue:V.ruleForm.valueColumn,"onUpdate:modelValue":e[5]||(e[5]=l=>V.ruleForm.valueColumn=l),class:"w100"},{default:r((()=>[(n(!0),s(f,null,b(V.columnData,(l=>(n(),p(m,{key:l.columnName,label:l.columnName+" ["+l.columnComment+"]",value:l.columnName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(N,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:r((()=>[d(v,{label:"父级字段",prop:"pidColumn"},{default:r((()=>[d(u,{modelValue:V.ruleForm.pidColumn,"onUpdate:modelValue":e[6]||(e[6]=l=>V.ruleForm.pidColumn=l),class:"w100"},{default:r((()=>[(n(!0),s(f,null,b(V.columnData,(l=>(n(),p(m,{key:l.columnName,label:l.columnName+" ["+l.columnComment+"]",value:l.columnName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}});export{N as _};

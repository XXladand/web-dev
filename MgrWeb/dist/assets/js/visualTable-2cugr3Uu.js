import{u as t}from"./vue-router-DCQgfElv.js";import{z as e}from"./relation-graph-BlBlBKOy.js";import{g as s}from"./index-DWGcUZYU.js";import{S as o}from"./sys-database-api-V52ZKqx1.js";import{d as a,_ as i,r,j as l,o as n,c as m,V as p,P as u,u as d,a as c,U as j,F as g,a8 as f,bm as v,bk as b,T as h}from"./@vue-CX_mlhJe.js";import{_ as x}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./screenfull-Cy98P-Xu.js";import"./@babel-Q_QrznUx.js";import"./html2canvas-BDxCGnia.js";import"./pinia-CUaEdNPK.js";import"./vue-demi-DMxTsK9-.js";import"./vue-DMOwXDUL.js";import"./jspdf-CH-AZmyM.js";import"./fflate-B3Xb404m.js";import"./vue-i18n-DOLUIXgH.js";import"./@intlify-8Jop7_C0.js";import"./js-cookie-BXEMiIsG.js";import"./@element-plus-BOmeTCVz.js";import"./nprogress-BXoedg-7.js";import"./axios-CURSphCx.js";import"./element-plus-B9gGnqkL.js";import"./lodash-es-Bx2dc0Qf.js";import"./@vueuse-DXufPiA3.js";import"./@sxzz-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-DCN6noHZ.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DHjS97uh.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-DUD0Qdrs.js";import"./vform3-builds-n_pM9nIF.js";import"./vue-signature-pad-lyh4QR3Z.js";import"./signature_pad-edH0THtw.js";import"./merge-images-Cwm9rL5U.js";import"./vue3-tree-org-BzkJto3m.js";/* empty css                    */import"./vue-plugin-hiprint-DZDwPE-S.js";import"./jquery-VSNIoD5U.js";import"./jsbarcode-BgYCXnWS.js";import"./socket.io-client-Czs-wWz3.js";import"./engine.io-client-CYjl6Vq_.js";import"./engine.io-parser-BcOgFIoq.js";import"./@socket.io-mcuM6LAc.js";import"./debug-CmirTkX5.js";import"./ms-CufoL-nS.js";import"./socket.io-parser-CnrqkM7d.js";import"./canvg-FiHv1N34.js";import"./core-js-BJmvCVxN.js";import"./raf-B8RiLMb0.js";import"./performance-now-D4QiMMAM.js";import"./rgbcolor-Cv9DR9SS.js";import"./svg-pathdata-BQypvdxQ.js";import"./stackblur-canvas-WbqePTkn.js";const y=t=>(v("data-v-4fa58108"),t=t(),b(),t),k={class:"sys-databaseVisual-container",style:{height:"calc(100vh - 60px)"}},N=y((()=>c("div",{style:{"z-index":"300",position:"absolute",left:"10px",top:"calc(100% - 50px)","font-size":"12px","background-color":"#ffffff",border:"#efefef solid 1px","border-radius":"10px",width:"260px",height:"40px",display:"flex","align-items":"center","justify-content":"center"}},[h(" 图例： "),c("div",null,[h(" 一对多 "),c("div",{style:{height:"5px",width:"80px","background-color":"rgba(0, 255, 0, 0.5)"}})]),c("div",{style:{"margin-left":"10px"}},[h(" 一对一 "),c("div",{style:{height:"5px",width:"80px","background-color":"rgba(255, 0, 0, 0.5)"}})])],-1))),_={style:{width:"500px","background-color":"#f39930"}},w={style:{height:"30px",display:"flex","align-items":"center","justify-content":"center"}},T={class:"c-data-table"},z=y((()=>c("tr",null,[c("th",null,"列名"),c("th",null,"类型"),c("th",null,"长度"),c("th",null,"描述")],-1))),C=["id"],D=a({name:"databaseVisual"}),I=x(a({...D,setup(a){const v=t(),b=i({loading:!1,configId:""}),h=r(null),x={defaultJunctionPoint:"border"};l((async()=>{b.configId=v.query.configId,y()}));const y=async()=>{var t,e,a,i,r=await s(o).apiSysDatabaseVisualDbTableGet();const l=null==(t=r.data.result)?void 0:t.visualTableList,n=null==(e=r.data.result)?void 0:e.visualColumnList,m=null==(a=r.data.result)?void 0:a.columnRelationList,p={nodes:l.map((t=>{const{tableName:e,tableComents:s,x:o,y:a}=t;return{id:e,text:s,x:o,y:a,nodeShape:1,data:{columns:n.filter((e=>e.tableName===t.tableName))}}})),lines:[],elementLines:m.map((t=>({from:t.sourceTableName+"-"+t.sourceColumnName,to:t.targetTableName+"-"+t.targetColumnName,color:"ONE_TO_ONE"===t.type?"rgba(255,0,0,0.5)":"rgba(0,255,0,0.5)",text:"",fromJunctionPoint:"left",toJunctionPoint:"lr",lineShape:6,lineWidth:3})))},u=null==(i=h.value)?void 0:i.getInstance();u&&(await u.setJsonData(p),await u.moveToCenter(),await u.zoomToFit())},D=(t,e)=>{},I=(t,e,s)=>{};return(t,s)=>(n(),m("div",k,[p(d(e),{ref_key:"graphRef",ref:h,options:x,"on-node-click":D,"on-line-click":I},{"graph-plug":u((()=>[N])),"canvas-plug":u((()=>[])),node:u((({node:t})=>[c("div",_,[c("div",w,j(t.text)+" - 【"+j(t.data.columns.length)+"列】",1),c("table",T,[z,(n(!0),m(g,null,f(t.data.columns,(e=>(n(),m("tr",{key:e.columnName},[c("td",null,[c("div",{id:`${t.id}-${e.columnName}`},j(e.columnName),9,C)]),c("td",null,j(e.dataType),1),c("td",null,j(e.dataLength),1),c("td",null,j(e.columnDescription),1)])))),128))])])])),_:1},512)]))}}),[["__scopeId","data-v-4fa58108"]]);export{I as default};

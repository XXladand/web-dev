import{V as e,a as l,b as a}from"./@vue-office-t3lTIXqd.js";import{_ as i}from"./editSysfile.vue_vue_type_script_setup_true_name_sysEditFile_lang-D9w2tY1U.js";import{_ as o}from"./modifyRecord.vue_vue_type_script_setup_true_lang-BJJtdc8n.js";import{d as t}from"./download-8-Ly9gws.js";import{g as s}from"./index-DWGcUZYU.js";import{S as r}from"./sys-file-api-DidooOQP.js";import{E as d,c as p}from"./element-plus-B9gGnqkL.js";import{d as n,r as m,_ as u,j as f,ah as c,ap as g,o as y,c as b,V as v,P as j,Q as h,O as w,T as _,U as x,a as V,u as P,S as k}from"./@vue-CX_mlhJe.js";import"./@babel-Q_QrznUx.js";import"./vue-demi-DMxTsK9-.js";import"./vue-DMOwXDUL.js";import"./pinia-CUaEdNPK.js";import"./jspdf-CH-AZmyM.js";import"./fflate-B3Xb404m.js";import"./vue-router-DCQgfElv.js";import"./vue-i18n-DOLUIXgH.js";import"./@intlify-8Jop7_C0.js";import"./js-cookie-BXEMiIsG.js";import"./@element-plus-BOmeTCVz.js";import"./nprogress-BXoedg-7.js";import"./axios-CURSphCx.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-DUD0Qdrs.js";import"./vform3-builds-n_pM9nIF.js";import"./vue-signature-pad-lyh4QR3Z.js";import"./signature_pad-edH0THtw.js";import"./merge-images-Cwm9rL5U.js";import"./vue3-tree-org-BzkJto3m.js";/* empty css                    */import"./vue-plugin-hiprint-DZDwPE-S.js";import"./jquery-VSNIoD5U.js";import"./jsbarcode-BgYCXnWS.js";import"./socket.io-client-Czs-wWz3.js";import"./engine.io-client-CYjl6Vq_.js";import"./engine.io-parser-BcOgFIoq.js";import"./@socket.io-mcuM6LAc.js";import"./debug-CmirTkX5.js";import"./ms-CufoL-nS.js";import"./socket.io-parser-CnrqkM7d.js";import"./canvg-FiHv1N34.js";import"./core-js-BJmvCVxN.js";import"./raf-B8RiLMb0.js";import"./performance-now-D4QiMMAM.js";import"./rgbcolor-Cv9DR9SS.js";import"./svg-pathdata-BQypvdxQ.js";import"./stackblur-canvas-WbqePTkn.js";import"./lodash-es-Bx2dc0Qf.js";import"./@vueuse-DXufPiA3.js";import"./@sxzz-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-DCN6noHZ.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DHjS97uh.js";const U={class:"sys-file-container"},z={style:{color:"#fff"}},N=V("span",null," 上传文件 ",-1),T=V("div",{class:"el-upload__text"},[_("将文件拖到此处，或"),V("em",null,"点击上传")],-1),F=V("div",{class:"el-upload__tip"},"请上传大小不超过 10MB 的文件",-1),q={class:"dialog-footer"},C=n({name:"sysFile"}),D=n({...C,setup(n){const C=m(),D=m(),S=u({loading:!1,fileData:[],queryParams:{fileName:void 0,startTime:void 0,endTime:void 0},tableParams:{page:1,pageSize:10,total:0},dialogUploadVisible:!1,diaglogEditFile:!1,fileList:[],dialogDocxVisible:!1,dialogXlsxVisible:!1,dialogPdfVisible:!1,showViewer:!1,docxUrl:"",excelUrl:"",pdfUrl:"",fileName:"",fileType:"",previewList:[]});f((async()=>{L()}));const L=async()=>{var e,l;null==S.queryParams.startTime&&(S.queryParams.startTime=void 0),null==S.queryParams.endTime&&(S.queryParams.endTime=void 0),S.loading=!0;let a=Object.assign(S.queryParams,S.tableParams);var i=await s(r).apiSysFilePagePost(a);S.fileData=(null==(e=i.data.result)?void 0:e.items)??[],S.tableParams.total=null==(l=i.data.result)?void 0:l.total,S.loading=!1},$=()=>{S.queryParams.fileName=void 0,S.queryParams.startTime=void 0,S.queryParams.endTime=void 0,L()},E=()=>{S.fileList=[],S.dialogUploadVisible=!0},M=(e,l)=>{S.fileList=l},Y=async()=>{S.fileList.length<1||(await s(r).apiSysFileUploadFilePostForm(S.fileList[0].raw,S.fileType,void 0),L(),d.success("上传成功"),S.dialogUploadVisible=!1)},R=e=>{S.tableParams.pageSize=e,L()},I=e=>{S.tableParams.page=e,L()},H=e=>"Local"==e.bucketName?`/${e.filePath}/${e.id}${e.suffix}`:e.url,B=()=>{},X=()=>{};return(n,m)=>{const u=c("el-input"),f=c("el-form-item"),O=c("el-date-picker"),Q=c("el-button"),K=c("el-button-group"),G=c("el-form"),A=c("el-card"),J=c("el-table-column"),W=c("el-tag"),Z=c("el-image"),ee=c("el-table"),le=c("el-pagination"),ae=c("ele-UploadFilled"),ie=c("el-icon"),oe=c("el-option"),te=c("el-select"),se=c("el-upload"),re=c("el-dialog"),de=c("el-drawer"),pe=c("el-image-viewer"),ne=g("auth"),me=g("loading");return y(),b("div",U,[v(A,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:j((()=>[v(G,{model:S.queryParams,ref:"queryForm",inline:!0},{default:j((()=>[v(f,{label:"文件名称",prop:"fileName"},{default:j((()=>[v(u,{modelValue:S.queryParams.fileName,"onUpdate:modelValue":m[0]||(m[0]=e=>S.queryParams.fileName=e),placeholder:"文件名称",clearable:""},null,8,["modelValue"])])),_:1}),v(f,{label:"开始时间",prop:"name"},{default:j((()=>[v(O,{modelValue:S.queryParams.startTime,"onUpdate:modelValue":m[1]||(m[1]=e=>S.queryParams.startTime=e),type:"datetime",placeholder:"开始时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1}),v(f,{label:"结束时间",prop:"code"},{default:j((()=>[v(O,{modelValue:S.queryParams.endTime,"onUpdate:modelValue":m[2]||(m[2]=e=>S.queryParams.endTime=e),type:"datetime",placeholder:"结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])])),_:1}),v(f,null,{default:j((()=>[v(K,null,{default:j((()=>[h((y(),w(Q,{type:"primary",icon:"ele-Search",onClick:L},{default:j((()=>[_(" 查询 ")])),_:1})),[[ne,"sysFile:page"]]),v(Q,{icon:"ele-Refresh",onClick:$},{default:j((()=>[_(" 重置 ")])),_:1})])),_:1})])),_:1}),v(f,null,{default:j((()=>[h((y(),w(Q,{type:"primary",icon:"ele-Plus",onClick:E},{default:j((()=>[_(" 上传 ")])),_:1})),[[ne,"sysFile:uploadFile"]])])),_:1})])),_:1},8,["model"])])),_:1}),v(A,{class:"full-table",shadow:"hover",style:{"margin-top":"5px"}},{default:j((()=>[h((y(),w(ee,{data:S.fileData,style:{width:"100%"},border:""},{default:j((()=>[v(J,{type:"index",label:"序号",width:"55",align:"center"}),v(J,{prop:"fileName",label:"名称","min-width":"150","header-align":"center","show-overflow-tooltip":""}),v(J,{prop:"suffix",label:"后缀",align:"center","show-overflow-tooltip":""},{default:j((e=>[v(W,{round:""},{default:j((()=>[_(x(e.row.suffix),1)])),_:2},1024)])),_:1}),v(J,{prop:"sizeKb",label:"大小kb",align:"center","show-overflow-tooltip":""}),v(J,{prop:"url",label:"预览",align:"center"},{default:j((e=>[v(Z,{style:{width:"60px",height:"60px"},src:H(e.row),alt:"无法预览",lazy:!0,"hide-on-click-modal":!0,"preview-src-list":[H(e.row)],"initial-index":0,fit:"scale-down","preview-teleported":""},{error:j((()=>[])),_:2},1032,["src","preview-src-list"])])),_:1}),v(J,{prop:"bucketName",label:"存储位置",align:"center","show-overflow-tooltip":""}),v(J,{prop:"id",label:"存储标识",align:"center","show-overflow-tooltip":""}),v(J,{prop:"fileType",label:"文件类型","min-width":"100","header-align":"center","show-overflow-tooltip":""}),v(J,{type:"relationName",label:"关联对象名称","min-width":"150",align:"center"}),v(J,{type:"relationId",label:"关联对象Id",align:"center"}),v(J,{type:"belongId",label:"所属Id",align:"center"}),v(J,{label:"修改记录",width:"100",align:"center","show-overflow-tooltip":""},{default:j((e=>[v(o,{data:e.row},null,8,["data"])])),_:1}),v(J,{label:"操作",width:"260",fixed:"right",align:"center","show-overflow-tooltip":""},{default:j((e=>[h((y(),w(Q,{icon:"ele-View",size:"small",text:"",type:"primary",onClick:l=>(async e=>{".pdf"==e.suffix?(S.fileName=`【${e.fileName}${e.suffix}】`,S.pdfUrl=H(e),S.dialogPdfVisible=!0):".docx"==e.suffix?(S.fileName=`【${e.fileName}${e.suffix}】`,S.docxUrl=H(e),S.dialogDocxVisible=!0):".xlsx"==e.suffix?(S.fileName=`【${e.fileName}${e.suffix}】`,S.excelUrl=H(e),S.dialogXlsxVisible=!0):[".jpg",".png",".jpeg",".bmp"].findIndex((l=>l==e.suffix))>-1?(S.previewList=[H(e)],S.showViewer=!0):d.error("此文件格式不支持预览")})(e.row)},{default:j((()=>[_(" 预览 ")])),_:2},1032,["onClick"])),[[ne,"sysFile:delete"]]),h((y(),w(Q,{icon:"ele-Download",size:"small",text:"",type:"primary",onClick:l=>(async e=>{var l=H(e);t({url:l})})(e.row)},{default:j((()=>[_(" 下载 ")])),_:2},1032,["onClick"])),[[ne,"sysFile:downloadFile"]]),h((y(),w(Q,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:l=>{return a=e.row,void p.confirm(`确定删除文件：【${a.fileName}】?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await s(r).apiSysFileDeletePost({id:a.id}),L(),d.success("删除成功")})).catch((()=>{}));var a}},{default:j((()=>[_(" 删除 ")])),_:2},1032,["onClick"])),[[ne,"sysFile:delete"]]),h((y(),w(Q,{icon:"ele-Edit",size:"small",text:"",type:"primary",onClick:l=>{return a=e.row,void(null==(i=D.value)||i.openDialog(a));var a,i}},{default:j((()=>[_(" 编辑 ")])),_:2},1032,["onClick"])),[[ne,"sysFile:update"]])])),_:1})])),_:1},8,["data"])),[[me,S.loading]]),v(le,{currentPage:S.tableParams.page,"onUpdate:currentPage":m[3]||(m[3]=e=>S.tableParams.page=e),"page-size":S.tableParams.pageSize,"onUpdate:pageSize":m[4]||(m[4]=e=>S.tableParams.pageSize=e),total:S.tableParams.total,"page-sizes":[10,20,50,100],size:"small",background:"",onSizeChange:R,onCurrentChange:I,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])),_:1}),v(re,{modelValue:S.dialogUploadVisible,"onUpdate:modelValue":m[7]||(m[7]=e=>S.dialogUploadVisible=e),"lock-scroll":!1,draggable:"",width:"400px"},{header:j((()=>[V("div",z,[v(ie,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:j((()=>[v(ae)])),_:1}),N])])),footer:j((()=>[V("span",q,[v(Q,{onClick:m[6]||(m[6]=e=>S.dialogUploadVisible=!1)},{default:j((()=>[_("取消")])),_:1}),v(Q,{type:"primary",onClick:Y},{default:j((()=>[_("确定")])),_:1})])])),default:j((()=>[V("div",null,[v(te,{modelValue:S.fileType,"onUpdate:modelValue":m[5]||(m[5]=e=>S.fileType=e),placeholder:"请选择文件类型",style:{"margin-bottom":"10px"}},{default:j((()=>[v(oe,{label:"相关文件",value:"相关文件"}),v(oe,{label:"归档文件",value:"归档文件"})])),_:1},8,["modelValue"]),v(se,{ref_key:"uploadRef",ref:C,drag:"","auto-upload":!1,limit:1,"file-list":S.fileList,action:"","on-change":M,accept:".jpg,.png,.bmp,.gif,.txt,.pdf,.xlsx,.docx"},{tip:j((()=>[F])),default:j((()=>[v(ie,{class:"el-icon--upload"},{default:j((()=>[v(ae)])),_:1}),T])),_:1},8,["file-list"])])])),_:1},8,["modelValue"]),v(de,{title:S.fileName,modelValue:S.dialogDocxVisible,"onUpdate:modelValue":m[8]||(m[8]=e=>S.dialogDocxVisible=e),size:"50%","destroy-on-close":""},{default:j((()=>[v(P(e),{src:S.docxUrl,style:{height:"100vh"},onRendered:B,onError:X},null,8,["src"])])),_:1},8,["title","modelValue"]),v(de,{title:S.fileName,modelValue:S.dialogXlsxVisible,"onUpdate:modelValue":m[9]||(m[9]=e=>S.dialogXlsxVisible=e),size:"50%","destroy-on-close":""},{default:j((()=>[v(P(l),{src:S.excelUrl,style:{height:"100vh"},onRendered:B,onError:X},null,8,["src"])])),_:1},8,["title","modelValue"]),v(de,{title:S.fileName,modelValue:S.dialogPdfVisible,"onUpdate:modelValue":m[10]||(m[10]=e=>S.dialogPdfVisible=e),size:"50%","destroy-on-close":""},{default:j((()=>[v(P(a),{src:S.pdfUrl,style:{height:"100vh"},onRendered:B,onError:X},null,8,["src"])])),_:1},8,["title","modelValue"]),S.showViewer?(y(),w(pe,{key:0,"url-list":S.previewList,hideOnClickModal:!0,onClose:m[11]||(m[11]=e=>S.showViewer=!1)},null,8,["url-list"])):k("",!0),v(i,{ref_key:"editSysFileRef",ref:D,title:"编辑文件",onHandleQuery:L},null,512)])}}});export{D as default};

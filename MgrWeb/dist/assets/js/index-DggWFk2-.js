import{g as e,a}from"./download-8-Ly9gws.js";import{B as t,j as o,g as s}from"./index-DWGcUZYU.js";import{a as r}from"./axios-CURSphCx.js";import{E as l}from"./element-plus-B9gGnqkL.js";import{d as i,_ as n,j as p,ah as d,ap as c,Q as m,o as u,c as g,V as h,P as w,O as f,T as y,a as b,U as v,bm as j,bk as P}from"./@vue-CX_mlhJe.js";import{_ as x}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./pinia-CUaEdNPK.js";import"./vue-demi-DMxTsK9-.js";import"./vue-DMOwXDUL.js";import"./@babel-Q_QrznUx.js";import"./jspdf-CH-AZmyM.js";import"./fflate-B3Xb404m.js";import"./vue-router-DCQgfElv.js";import"./vue-i18n-DOLUIXgH.js";import"./@intlify-8Jop7_C0.js";import"./js-cookie-BXEMiIsG.js";import"./@element-plus-BOmeTCVz.js";import"./nprogress-BXoedg-7.js";import"./mitt-CNZ6avp8.js";import"./vue-grid-layout-DUD0Qdrs.js";import"./vform3-builds-n_pM9nIF.js";import"./vue-signature-pad-lyh4QR3Z.js";import"./signature_pad-edH0THtw.js";import"./merge-images-Cwm9rL5U.js";import"./vue3-tree-org-BzkJto3m.js";/* empty css                    */import"./vue-plugin-hiprint-DZDwPE-S.js";import"./jquery-VSNIoD5U.js";import"./jsbarcode-BgYCXnWS.js";import"./socket.io-client-Czs-wWz3.js";import"./engine.io-client-CYjl6Vq_.js";import"./engine.io-parser-BcOgFIoq.js";import"./@socket.io-mcuM6LAc.js";import"./debug-CmirTkX5.js";import"./ms-CufoL-nS.js";import"./socket.io-parser-CnrqkM7d.js";import"./canvg-FiHv1N34.js";import"./core-js-BJmvCVxN.js";import"./raf-B8RiLMb0.js";import"./performance-now-D4QiMMAM.js";import"./rgbcolor-Cv9DR9SS.js";import"./svg-pathdata-BQypvdxQ.js";import"./stackblur-canvas-WbqePTkn.js";import"./lodash-es-Bx2dc0Qf.js";import"./@vueuse-DXufPiA3.js";import"./@sxzz-D3lHDW-0.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-DCN6noHZ.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DHjS97uh.js";const S=function(e){return{apiSysLogExClearPost:async(a={})=>{const t=new URL("/api/sysLogEx/clear","https://example.com");let o;e&&(o=e.baseOptions);const s={method:"POST",...o,...a},r={},l={};if(e&&e.accessToken){const a="function"==typeof e.accessToken?await e.accessToken():await e.accessToken;r.Authorization="Bearer "+a}const i=new URLSearchParams(t.search);for(const e in l)i.set(e,l[e]);for(const e in a.params)i.set(e,a.params[e]);t.search=new URLSearchParams(i).toString();let n=o&&o.headers?o.headers:{};return s.headers={...r,...n,...a.headers},{url:t.pathname+t.search+t.hash,options:s}},apiSysLogExExportPost:async(a,t={})=>{const o=new URL("/api/sysLogEx/export","https://example.com");let s;e&&(s=e.baseOptions);const r={method:"POST",...s,...t},l={},i={};if(e&&e.accessToken){const a="function"==typeof e.accessToken?await e.accessToken():await e.accessToken;l.Authorization="Bearer "+a}l["Content-Type"]="application/json-patch+json";const n=new URLSearchParams(o.search);for(const e in i)n.set(e,i[e]);for(const e in t.params)n.set(e,t.params[e]);o.search=new URLSearchParams(n).toString();let p=s&&s.headers?s.headers:{};r.headers={...l,...p,...t.headers};const d="string"!=typeof a||"application/json"===r.headers["Content-Type"];return r.data=d?JSON.stringify(void 0!==a?a:{}):a||"",{url:o.pathname+o.search+o.hash,options:r}},apiSysLogExPagePost:async(a,t={})=>{const o=new URL("/api/sysLogEx/page","https://example.com");let s;e&&(s=e.baseOptions);const r={method:"POST",...s,...t},l={},i={};if(e&&e.accessToken){const a="function"==typeof e.accessToken?await e.accessToken():await e.accessToken;l.Authorization="Bearer "+a}l["Content-Type"]="application/json-patch+json";const n=new URLSearchParams(o.search);for(const e in i)n.set(e,i[e]);for(const e in t.params)n.set(e,t.params[e]);o.search=new URLSearchParams(n).toString();let p=s&&s.headers?s.headers:{};r.headers={...l,...p,...t.headers};const d="string"!=typeof a||"application/json"===r.headers["Content-Type"];return r.data=d?JSON.stringify(void 0!==a?a:{}):a||"",{url:o.pathname+o.search+o.hash,options:r}}}},T=function(e){return{async apiSysLogExClearPost(a){const t=await S(e).apiSysLogExClearPost(a);return(e=r,a=o)=>{const s={...t.options,url:a+t.url};return e.request(s)}},async apiSysLogExExportPost(a,t){const s=await S(e).apiSysLogExExportPost(a,t);return(e=r,a=o)=>{const t={...s.options,url:a+s.url};return e.request(t)}},async apiSysLogExPagePost(a,t){const s=await S(e).apiSysLogExPagePost(a,t);return(e=r,a=o)=>{const t={...s.options,url:a+s.url};return e.request(t)}}}};class L extends t{async apiSysLogExClearPost(e){return T(this.configuration).apiSysLogExClearPost(e).then((e=>e(this.axios,this.basePath)))}async apiSysLogExExportPost(e,a){return T(this.configuration).apiSysLogExExportPost(e,a).then((e=>e(this.axios,this.basePath)))}async apiSysLogExPagePost(e,a){return T(this.configuration).apiSysLogExPagePost(e,a).then((e=>e(this.axios,this.basePath)))}}const k={class:"sys-exlog-container"},E={style:{color:"#fff"}},_=(e=>(j("data-v-2a772b7e"),e=e(),P(),e))((()=>b("span",null," 日志详情 ",-1))),q=i({name:"sysExLog"}),C=x(i({...q,setup(t){const o=n({loading:!1,queryParams:{startTime:void 0,endTime:void 0},tableParams:{page:1,pageSize:20,field:"createTime",order:"descending",descStr:"descending",total:0},logData:[],dialogVisible:!1,content:""});p((async()=>{r()}));const r=async()=>{var e,a;null==o.queryParams.startTime&&(o.queryParams.startTime=void 0),null==o.queryParams.endTime&&(o.queryParams.endTime=void 0),o.loading=!0;let t=Object.assign(o.queryParams,o.tableParams);var r=await s(L).apiSysLogExPagePost(t);o.logData=(null==(e=r.data.result)?void 0:e.items)??[],o.tableParams.total=null==(a=r.data.result)?void 0:a.total,o.loading=!1},i=()=>{o.queryParams.startTime=void 0,o.queryParams.endTime=void 0,r()},j=async()=>{o.loading=!0,await s(L).apiSysLogExClearPost(),o.loading=!1,l.success("清空成功"),r()},P=async()=>{o.loading=!0;var t=await s(L).apiSysLogExExportPost(o.queryParams,{responseType:"blob"});o.loading=!1;var r=e(t.headers);a(t.data,r)},x=e=>{o.tableParams.pageSize=e,r()},S=e=>{o.tableParams.page=e,r()},T=e=>null!=e.row.exception?"warning-row":"",q=[{text:"今天",value:new Date},{text:"昨天",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}},{text:"上周",value:()=>{const e=new Date;return e.setTime(e.getTime()-6048e5),e}}],C=e=>{o.tableParams.field=e.prop,o.tableParams.order=e.order,r()};return(e,a)=>{const t=d("el-date-picker"),s=d("el-form-item"),l=d("el-button"),n=d("el-button-group"),p=d("el-form"),L=d("el-card"),z=d("el-table-column"),U=d("el-tag"),D=d("el-table"),V=d("el-pagination"),O=d("ele-Document"),I=d("el-icon"),R=d("el-dialog"),Y=c("auth"),M=c("loading");return m((u(),g("div",k,[h(L,{shadow:"hover","body-style":{paddingBottom:"0"}},{default:w((()=>[h(p,{model:o.queryParams,ref:"queryForm",inline:!0},{default:w((()=>[h(s,{label:"开始时间"},{default:w((()=>[h(t,{modelValue:o.queryParams.startTime,"onUpdate:modelValue":a[0]||(a[0]=e=>o.queryParams.startTime=e),type:"datetime",placeholder:"开始时间","value-format":"YYYY-MM-DD HH:mm:ss",shortcuts:q},null,8,["modelValue"])])),_:1}),h(s,{label:"结束时间"},{default:w((()=>[h(t,{modelValue:o.queryParams.endTime,"onUpdate:modelValue":a[1]||(a[1]=e=>o.queryParams.endTime=e),type:"datetime",placeholder:"结束时间","value-format":"YYYY-MM-DD HH:mm:ss",shortcuts:q},null,8,["modelValue"])])),_:1}),h(s,null,{default:w((()=>[h(n,null,{default:w((()=>[m((u(),f(l,{type:"primary",icon:"ele-Search",onClick:r},{default:w((()=>[y(" 查询 ")])),_:1})),[[Y,"sysExlog:page"]]),h(l,{icon:"ele-Refresh",onClick:i},{default:w((()=>[y(" 重置 ")])),_:1})])),_:1})])),_:1}),h(s,null,{default:w((()=>[m((u(),f(l,{icon:"ele-DeleteFilled",type:"danger",onClick:j},{default:w((()=>[y(" 清空 ")])),_:1})),[[Y,"sysExlog:clear"]]),m((u(),f(l,{icon:"ele-FolderOpened",onClick:P},{default:w((()=>[y(" 导出 ")])),_:1})),[[Y,"sysExlog:export"]])])),_:1})])),_:1},8,["model"])])),_:1}),h(L,{class:"full-table",shadow:"hover",style:{"margin-top":"5px"}},{default:w((()=>[h(D,{data:o.logData,onSortChange:C,style:{width:"100%"},border:"","row-class-name":T},{default:w((()=>[h(z,{type:"index",label:"序号",width:"55",align:"center"}),h(z,{prop:"controllerName",label:"模块名称",width:"100","header-align":"center","show-overflow-tooltip":""}),h(z,{prop:"displayTitle",label:"显示名称",width:"150","header-align":"center","show-overflow-tooltip":""}),h(z,{prop:"actionName",label:"方法名称",width:"100","header-align":"center","show-overflow-tooltip":""}),h(z,{prop:"httpMethod",label:"请求方式",width:"90",align:"center","show-overflow-tooltip":""}),h(z,{prop:"requestUrl",label:"请求地址",width:"300","header-align":"center","show-overflow-tooltip":""}),h(z,{prop:"logLevel",label:"级别",width:"70",align:"center","show-overflow-tooltip":""},{default:w((e=>[1===e.row.logLevel?(u(),f(U,{key:0},{default:w((()=>[y("调试")])),_:1})):2===e.row.logLevel?(u(),f(U,{key:1},{default:w((()=>[y("消息")])),_:1})):3===e.row.logLevel?(u(),f(U,{key:2},{default:w((()=>[y("警告")])),_:1})):4===e.row.logLevel?(u(),f(U,{key:3},{default:w((()=>[y("错误")])),_:1})):(u(),f(U,{key:4},{default:w((()=>[y("其他")])),_:1}))])),_:1}),h(z,{prop:"eventId",label:"事件Id",width:"70",align:"center","show-overflow-tooltip":""}),h(z,{prop:"threadId",label:"线程Id",sortable:"custom",width:"90",align:"center","show-overflow-tooltip":""}),h(z,{prop:"traceId",label:"请求跟踪Id",width:"150","header-align":"center",sortable:"custom","show-overflow-tooltip":""}),h(z,{prop:"account",label:"账号名称",width:"100",align:"center","show-overflow-tooltip":""}),h(z,{prop:"realName",label:"真实姓名",width:"100",align:"center","show-overflow-tooltip":""}),h(z,{prop:"remoteIp",label:"IP地址",width:"120",align:"center","show-overflow-tooltip":""}),h(z,{prop:"location",label:"登录地点",width:"150",align:"center","show-overflow-tooltip":""}),h(z,{prop:"longitude",label:"经度","min-width":"100",align:"center","show-overflow-tooltip":""}),h(z,{prop:"latitude",label:"纬度","min-width":"100",align:"center","show-overflow-tooltip":""}),h(z,{prop:"browser",label:"浏览器",width:"160",align:"center","show-overflow-tooltip":""}),h(z,{prop:"os",label:"操作系统",width:"120",align:"center","show-overflow-tooltip":""}),h(z,{prop:"status",label:"状态",width:"70",align:"center","show-overflow-tooltip":""},{default:w((e=>["200"===e.row.status?(u(),f(U,{key:0,type:"success"},{default:w((()=>[y("成功")])),_:1})):(u(),f(U,{key:1,type:"danger"},{default:w((()=>[y("失败")])),_:1}))])),_:1}),h(z,{prop:"elapsed",label:"耗时(ms)",width:"90",align:"center","show-overflow-tooltip":""}),h(z,{prop:"exception",label:"异常对象",width:"150","header-align":"center","show-overflow-tooltip":""}),h(z,{prop:"logDateTime",label:"日志时间",width:"160",align:"center",fixed:"right","show-overflow-tooltip":""}),h(z,{label:"操作",width:"80",align:"center",fixed:"right","show-overflow-tooltip":""},{default:w((e=>[m((u(),f(l,{icon:"ele-InfoFilled",size:"small",text:"",type:"primary",onClick:a=>{return t=e.row,o.content=t.message,void(o.dialogVisible=!0);var t}},{default:w((()=>[y("详情 ")])),_:2},1032,["onClick"])),[[Y,"sysOplog:page"]])])),_:1})])),_:1},8,["data"]),h(V,{currentPage:o.tableParams.page,"onUpdate:currentPage":a[2]||(a[2]=e=>o.tableParams.page=e),"page-size":o.tableParams.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>o.tableParams.pageSize=e),total:o.tableParams.total,"page-sizes":[10,20,50,100],size:"small",background:"",onSizeChange:x,onCurrentChange:S,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])),_:1}),h(R,{modelValue:o.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>o.dialogVisible=e),draggable:"",fullscreen:""},{header:w((()=>[b("div",E,[h(I,{size:"16",style:{"margin-right":"3px",display:"inline","vertical-align":"middle"}},{default:w((()=>[h(O)])),_:1}),_])])),default:w((()=>[b("pre",null,v(o.content),1)])),_:1},8,["modelValue"])])),[[M,o.loading]])}}}),[["__scopeId","data-v-2a772b7e"]]);export{C as default};
